import"../../../vendor/vue-7c9b4e57.js";import{a as L,u as j,g as ye,_ as M,r as y,l as ce,E as P,e as le,b as we,c as ke,d as xe,f as Ee,h as Pe}from"../../builder/index-bbe75387.js";import{d as de}from"../../../vendor/pinia-29b2e896.js";import{r as B,d as _e,l as C,k as Be,ai as f,o as _,c as p,u as n,a as l,M as b,P as ue,R as g,J as v,a7 as Ve,O as E,Q as Me,a6 as Re,F as qe,I as Ce}from"../../../vendor/@vue-b9898b5a.js";import{b as Le}from"../../../vendor/element-plus-616bd1f6.js";const Ae=async r=>{var s;const{siteInfo:t}=L(),e=(s=t==null?void 0:t.public_api)==null?void 0:s.menus;return e?await j(e,r).then(a=>a.data):Promise.reject("菜单接口未配置")},De=(r,t)=>{const e=r[t];return e?typeof e=="function"?e():Promise.resolve(e):new Promise((s,a)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(a.bind(null,new Error("Unknown variable dynamic import: "+t)))})},je=r=>{const t=ce.path.split("/")[1]??"";return[...r,{...ce,id:1e5,path:`layout/${t}`,component:"exception",method:"GET",title:"错误异常",short_title:"异常",is_show:"10"}]},Oe=r=>{const t=[];for(const e of r){const s={title:e.title,path:e.path,method:e.method,icon:e.icon,ajaxParams:ye(e.params),remote:e.params},a=e.component?e.component:"builder",u={path:`/${e.path}`,name:e.path.replaceAll("/","_"),component:()=>De(Object.assign({"../pages/builder/index.vue":()=>M(()=>import("../../builder/index-bbe75387.js").then(m=>m.z),["assets/views/builder/index-bbe75387.js","assets/vendor/vue-7c9b4e57.js","assets/vendor/@vue-b9898b5a.js","assets/vendor/axios-a921b253.js","assets/vendor/vue-router-776dd066.js","assets/vendor/@vueuse-2006ee9f.js","assets/vendor/element-plus-616bd1f6.js","assets/vendor/lodash-es-4da90d2e.js","assets/vendor/@element-plus-950f8d06.js","assets/vendor/@sxzz-c75af06c.js","assets/vendor/@ctrl-f8748455.js","assets/vendor/dayjs-f13f0179.js","assets/vendor/call-bind-apply-helpers-be8cb158.js","assets/vendor/function-bind-48f717dc.js","assets/vendor/es-errors-c75f5a96.js","assets/vendor/async-validator-dee29e8b.js","assets/vendor/memoize-one-297ddbcb.js","assets/vendor/normalize-wheel-es-ed76fb12.js","assets/vendor/@floating-ui-606f2ab9.js","assets/static/css/element-plus.c6a7ed46.css","assets/vendor/pinia-29b2e896.js","assets/vendor/vue-demi-09065cd0.js","assets/static/css/index.3367304f.css"]),"../pages/exception/index.vue":()=>M(()=>import("../../exception/index-f4c527a1.js"),["assets/views/exception/index-f4c527a1.js","assets/vendor/vue-7c9b4e57.js","assets/vendor/@vue-b9898b5a.js","assets/views/builder/index-bbe75387.js","assets/vendor/axios-a921b253.js","assets/vendor/vue-router-776dd066.js","assets/vendor/@vueuse-2006ee9f.js","assets/vendor/element-plus-616bd1f6.js","assets/vendor/lodash-es-4da90d2e.js","assets/vendor/@element-plus-950f8d06.js","assets/vendor/@sxzz-c75af06c.js","assets/vendor/@ctrl-f8748455.js","assets/vendor/dayjs-f13f0179.js","assets/vendor/call-bind-apply-helpers-be8cb158.js","assets/vendor/function-bind-48f717dc.js","assets/vendor/es-errors-c75f5a96.js","assets/vendor/async-validator-dee29e8b.js","assets/vendor/memoize-one-297ddbcb.js","assets/vendor/normalize-wheel-es-ed76fb12.js","assets/vendor/@floating-ui-606f2ab9.js","assets/static/css/element-plus.c6a7ed46.css","assets/vendor/pinia-29b2e896.js","assets/vendor/vue-demi-09065cd0.js","assets/static/css/index.3367304f.css"]),"../pages/login/index.vue":()=>M(()=>import("../index-cd1376bc.js"),["assets/views/login/index-cd1376bc.js","assets/vendor/vue-7c9b4e57.js","assets/vendor/@vue-b9898b5a.js","assets/views/login/component/remote-e1759304.js","assets/views/builder/index-bbe75387.js","assets/vendor/axios-a921b253.js","assets/vendor/vue-router-776dd066.js","assets/vendor/@vueuse-2006ee9f.js","assets/vendor/element-plus-616bd1f6.js","assets/vendor/lodash-es-4da90d2e.js","assets/vendor/@element-plus-950f8d06.js","assets/vendor/@sxzz-c75af06c.js","assets/vendor/@ctrl-f8748455.js","assets/vendor/dayjs-f13f0179.js","assets/vendor/call-bind-apply-helpers-be8cb158.js","assets/vendor/function-bind-48f717dc.js","assets/vendor/es-errors-c75f5a96.js","assets/vendor/async-validator-dee29e8b.js","assets/vendor/memoize-one-297ddbcb.js","assets/vendor/normalize-wheel-es-ed76fb12.js","assets/vendor/@floating-ui-606f2ab9.js","assets/static/css/element-plus.c6a7ed46.css","assets/vendor/pinia-29b2e896.js","assets/vendor/vue-demi-09065cd0.js","assets/static/css/index.3367304f.css"]),"../pages/redirect/index.vue":()=>M(()=>import("../../redirect/index-db44fca7.js"),["assets/views/redirect/index-db44fca7.js","assets/vendor/vue-7c9b4e57.js","assets/vendor/@vue-b9898b5a.js","assets/vendor/vue-router-776dd066.js"]),"../pages/workbench/index.vue":()=>M(()=>import("../../workbench/index-d1d105e3.js"),["assets/views/workbench/index-d1d105e3.js","assets/vendor/vue-7c9b4e57.js","assets/vendor/@vue-b9898b5a.js","assets/views/builder/index-bbe75387.js","assets/vendor/axios-a921b253.js","assets/vendor/vue-router-776dd066.js","assets/vendor/@vueuse-2006ee9f.js","assets/vendor/element-plus-616bd1f6.js","assets/vendor/lodash-es-4da90d2e.js","assets/vendor/@element-plus-950f8d06.js","assets/vendor/@sxzz-c75af06c.js","assets/vendor/@ctrl-f8748455.js","assets/vendor/dayjs-f13f0179.js","assets/vendor/call-bind-apply-helpers-be8cb158.js","assets/vendor/function-bind-48f717dc.js","assets/vendor/es-errors-c75f5a96.js","assets/vendor/async-validator-dee29e8b.js","assets/vendor/memoize-one-297ddbcb.js","assets/vendor/normalize-wheel-es-ed76fb12.js","assets/vendor/@floating-ui-606f2ab9.js","assets/static/css/element-plus.c6a7ed46.css","assets/vendor/pinia-29b2e896.js","assets/vendor/vue-demi-09065cd0.js","assets/static/css/index.3367304f.css","assets/static/css/index.efddd899.css"])}),`../pages/${a}/index.vue`),meta:s};if(e.children&&e.children.length>0){const m=Oe(e.children);t.push(...m)}t.push(u)}return t},Lt=r=>{for(const t of r)y.addRoute("default-router",t)},pe=(r,t)=>r.map(s=>{const a=s.id.toString(),u=Array.isArray(s.children)&&s.children.length>0?pe(s.children,t?`${t}-${s.id}`:a):[],m=u.filter(h=>h.show)??[],w=u.length>0&&m.length>0,c=s.is_show==="20";return{...s,show:c,isGroup:w,children:u,menu_key:t?`${t}-${s.id}`:a,icon:s.icon??""}}),Te=r=>{const t=B([]),e=a=>{var u;for(const m of a)(u=m.children)!=null&&u.length&&e(m.children),t.value.push(m.path)};return e(r),t.value.filter(a=>a==="workbench").length>0},Ue=de("menus",()=>{const r=B([]);return{menus:r,getMenus:async s=>{const a=Object.assign({},y.currentRoute.value.query,s),u=await Ae(a);if(!u)return P.push({path:le,query:{message:"获取权限菜单失败"}}),Promise.reject(new Error("获取菜单失败"));if(!Te(u))return P.push({path:le,query:{message:"系统错误，工作台菜单不存在"}}),Promise.reject(new Error("工作台菜单已存在"));const m=je(u),w=pe(m);return r.value=w,w},clearMenus:()=>{r.value=[]}}}),$e=async r=>{var u;const{siteInfo:t}=L(),e=(u=t==null?void 0:t.public_api)==null?void 0:u.login;if(!e)return P.confirm({title:"温馨提示",message:"未设置登录接口",type:"error",showCancelButton:!1}),Promise.reject(new Error("未设置登录接口"));const s=y.currentRoute.value.query??{},a=Object.assign(r,s);return await we(e,a)},Se=async r=>{var s;const{siteInfo:t}=L(),e=(s=t==null?void 0:t.public_api)==null?void 0:s.user;return e?await j(e,r).then(a=>a==null?void 0:a.data):(P.confirm({title:"温馨提示",message:"请配置用户信息接口",type:"error",showCancelButton:!1}),Promise.reject(new Error("请配置用户信息接口")))},ze=(r,t="温馨提示",e="",s)=>Le.confirm(r,t,{closeOnClickModal:!1,confirmButtonText:"确定",cancelButtonText:"取消",showCancelButton:!0,type:e,...s}),Ne=de("user",()=>{const r=ke(),t=B(),e=c=>{if(!c)return xe("令牌数据错误","温馨提示");c.includes("Bearer")||(c=`Bearer ${c}`),r.value=c},s=c=>{t.value=c},a=async c=>{if(!r.value)return Promise.reject("未登录");const i={...y.currentRoute.value.query??{},...c},h=await Se(i);return h?(s(h),h):(P.confirm({title:"温馨提示",message:"获取用户信息失败",type:"error",showCancelButton:!1}),Promise.reject(h))},u=async c=>{var V,R;const i=await $e(c);if(!((V=i==null?void 0:i.data)!=null&&V.access_token))return P.confirm({title:"温馨提示",message:"登录失败，身份令牌参数错误",type:"error",showCancelButton:!1}),Promise.reject(i);e(i.data.access_token);const h=(R=y.currentRoute.value.query)==null?void 0:R.redirect;P.push({path:h||"/",query:{...y.currentRoute.value.query}})},m=()=>{var h;r.value="",s(),Ue().clearMenus();const c=B((h=y.currentRoute.value.query)==null?void 0:h.redirect);c.value||(c.value=y.currentRoute.value.path);const i=y.currentRoute.value.query;i!=null&&i.redirect&&delete i.redirect,y.push({path:Ee,query:{...i,redirect:c.value}})},w=()=>{ze("是否确认退出登录？","温馨提示","error").then(()=>{m()})};return{userInfo:t,getToken:r.value,setToken:e,accounLogin:u,clearLoginOut:m,loginOut:w,getUserInfo:a}}),Fe="/backend/assets/static/png/login-banner.bbcf3da2.png",Ge="/backend/assets/static/png/login-bg.503d1dd6.png",He={key:0,class:"login-bg",autoplay:"",loop:"",muted:""},Je=["src"],Qe={class:"login-position"},We={key:0,class:"mobile-qrcode"},Xe={class:"qrcode-box"},Ye={class:"title"},Ze={key:1,class:"login-box"},Ke={class:"login-bg"},Ie={key:0,id:"banner",autoplay:"",loop:"",muted:""},et=["src"],tt=["src"],ot={class:"login-content"},nt={class:"logo-container"},st={class:"title"},rt={class:"form-container"},at={class:"item"},it={class:"item"},ct={key:0,class:"item"},lt={class:"captcha-container"},ut={class:"submit-button"},dt={key:0,class:"backurl-container"},_t={class:"backurl"},pt=["href"],gt={key:0,class:"register-findpwd"},mt={key:0,class:"register"},ht={key:1,class:"password"},vt={key:1,class:"register-password"},ft={key:0,class:"register"},bt={key:1,class:"password"},yt={key:2,class:"other-login"},wt={class:"other-conntent"},kt={class:"other-item"},xt=["src"],Et={key:1,class:"xbase-copyright"},Pt=_e({name:"/login/component/login"}),Bt=_e({...Pt,setup(r){var O;const{accounLogin:t}=Ne(),{siteInfo:e}=L(),s=()=>{const d=navigator.userAgent.toLowerCase();return/iphone|ipad|ipod|android|iemobile|blackberry|windows phone/.test(d)},a=C(()=>{var d;return(d=e==null?void 0:e.login_data)!=null&&d.login_bg?e==null?void 0:e.login_data.login_bg.includes(".mp4"):!1}),u=C(()=>{var d,o,x;return(d=e==null?void 0:e.login_data)!=null&&d.login_bg&&((o=e==null?void 0:e.login_data)!=null&&o.login_bg.includes(".mp4"))?e==null?void 0:e.login_data.login_bg:(x=e==null?void 0:e.login_data)!=null&&x.login_bg?`background-image:url(${e==null?void 0:e.login_data.login_bg});`:`background-image:url(${Ge});`}),m=C(()=>{var d,o;return(d=e==null?void 0:e.login_data)!=null&&d.login_ad?(o=e==null?void 0:e.login_data)==null?void 0:o.login_ad.includes(".mp4"):!1}),w=B(((O=e==null?void 0:e.login_data)==null?void 0:O.login_ad)||Fe),c=B(""),i=B({username:"",password:"",vcode:""}),h=()=>{t(i.value)},V=async()=>{var x;const d=(x=e==null?void 0:e.public_api)==null?void 0:x.captcha;if(!d)return"";const o=await j(d);typeof o=="string"&&(c.value=o)},R=C(()=>"");return Be(()=>{V();var d=document.getElementById("banner");d!==null&&(d.autoplay=!0,d.addEventListener("contextmenu",function(o){o.preventDefault()}))}),(d,o)=>{var T,U,$,S,z,N,F,G,H,J,Q,W,X,Y,Z,K,I,ee,te,oe,ne,se,re,ae,ie;const x=f("el-image"),A=f("xbIcons"),D=f("el-input"),ge=f("el-button"),me=f("el-form"),q=f("router-link"),he=f("el-divider"),ve=f("el-tooltip"),fe=f("xbBeian"),be=f("xbCopyright");return _(),p("div",{class:"login-container",style:qe(n(a)?"":n(u))},[n(a)?(_(),p("video",He,[l("source",{src:n(u),type:"video/mp4"},null,8,Je)])):b("",!0),l("div",Qe,[s()?(_(),p("div",We,[l("div",Xe,[l("div",Ye,ue(((T=n(e))==null?void 0:T.web_name)||"xbcode"),1),o[3]||(o[3]=l("div",{class:"subtitle"},"请使用长按保存二维码访问",-1)),g(x,{src:n(R),class:"qrcode-img",alt:"访问二维码"},null,8,["src"]),o[4]||(o[4]=l("div",{class:"qrcode-tip"},"扫描二维码访问完整版",-1))])])):(_(),p("div",Ze,[l("div",Ke,[n(m)?(_(),p("video",Ie,[l("source",{src:n(w),type:"video/mp4"},null,8,et)])):(_(),p("img",{key:1,class:"login-banner",src:n(w)},null,8,tt))]),l("div",ot,[l("div",nt,[l("div",st,ue((($=(U=n(e))==null?void 0:U.login_data)==null?void 0:$.login_title)||"用户登录"),1)]),l("div",rt,[g(me,{onKeyup:Ve(h,["enter","native"])},{default:v(()=>[l("div",at,[g(D,{modelValue:n(i).username,"onUpdate:modelValue":o[0]||(o[0]=k=>n(i).username=k),placeholder:"请填写登录账号",size:"large"},{prefix:v(()=>[g(A,{icon:"UserFilled"})]),_:1},8,["modelValue"])]),l("div",it,[g(D,{modelValue:n(i).password,"onUpdate:modelValue":o[1]||(o[1]=k=>n(i).password=k),type:"password",placeholder:"请填写登录密码",size:"large","show-password":""},{prefix:v(()=>[g(A,{icon:"Lock"})]),_:1},8,["modelValue"])]),n(c)?(_(),p("div",ct,[l("div",lt,[g(D,{modelValue:n(i).vcode,"onUpdate:modelValue":o[2]||(o[2]=k=>n(i).vcode=k),placeholder:"请输入验证码",size:"large"},{prefix:v(()=>[g(A,{icon:"Picture"})]),_:1},8,["modelValue"]),g(x,{class:"captcha",src:n(c),onClick:V},null,8,["src"])])])):b("",!0),l("div",ut,[g(ge,{type:"primary",class:"submit",onClick:h},{default:v(()=>o[5]||(o[5]=[E(" 登录 ")])),_:1})])]),_:1}),(z=(S=n(e))==null?void 0:S.login_data)!=null&&z.back_url?(_(),p("div",dt,[l("div",_t,[l("a",{href:(N=n(e))==null?void 0:N.login_data.back_url}," 返回首页 ",8,pt)]),(F=n(e))!=null&&F.login_data.register||(G=n(e))!=null&&G.login_data.findpwd?(_(),p("div",gt,[(H=n(e))!=null&&H.login_data.register?(_(),p("div",mt,[g(q,{to:(J=n(e))==null?void 0:J.login_data.register},{default:v(()=>o[6]||(o[6]=[E(" 立即注册 ")])),_:1},8,["to"])])):b("",!0),(Q=n(e))!=null&&Q.login_data.findpwd?(_(),p("div",ht,[g(q,{to:(W=n(e))==null?void 0:W.login_data.findpwd},{default:v(()=>o[7]||(o[7]=[E(" 忘记密码 ")])),_:1},8,["to"])])):b("",!0)])):b("",!0)])):(Y=(X=n(e))==null?void 0:X.login_data)!=null&&Y.register||(K=(Z=n(e))==null?void 0:Z.login_data)!=null&&K.findpwd?(_(),p("div",vt,[(I=n(e))!=null&&I.login_data.register?(_(),p("div",ft,[o[9]||(o[9]=E(" 没有账号？ ")),g(q,{to:(ee=n(e))==null?void 0:ee.login_data.register},{default:v(()=>o[8]||(o[8]=[E(" 立即注册 ")])),_:1},8,["to"])])):b("",!0),(te=n(e))!=null&&te.login_data.findpwd?(_(),p("div",bt,[g(q,{to:(oe=n(e))==null?void 0:oe.login_data.findpwd},{default:v(()=>o[10]||(o[10]=[E(" 忘记密码 ")])),_:1},8,["to"])])):b("",!0)])):b("",!0),(re=(se=(ne=n(e))==null?void 0:ne.login_data)==null?void 0:se.other_login)!=null&&re.length?(_(),p("div",yt,[g(he,null,{default:v(()=>o[11]||(o[11]=[E(" 其他登录方式 ")])),_:1}),l("div",wt,[(_(!0),p(Me,null,Re((ae=n(e))==null?void 0:ae.login_data.other_login,k=>(_(),Ce(ve,{key:k,effect:"dark",content:k.title,placement:"top"},{default:v(()=>[l("div",kt,[l("img",{src:k.icon,class:"other-logo"},null,8,xt)])]),_:2},1032,["content"]))),128))])])):b("",!0)])])]))]),(ie=n(e))!=null&&ie.about_name?(_(),p("div",Et,[g(fe),g(be)])):b("",!0)],4)}}});const At=Pe(Bt,[["__scopeId","data-v-059bec88"]]);export{At as L,Oe as a,ze as b,Ue as m,Lt as r,Ne as u};

import"./vendor/vue-b5f628c3.js";import{m as Ce,u as xe,a as wt,r as pt,b as A}from"./views/login/component/login-32a99be5.js";import{u as Ke,b as Ct}from"./vendor/vue-router-18dbe4bf.js";import{w as xt}from"./vendor/@vueuse-cb382515.js";import{r as C,_ as le,h as kt,af as At,d as T,ai as x,o as m,K as O,w as Et,k as X,c as g,a as h,R as I,u as l,G as Me,X as Qe,au as ke,aG as Rt,aH as ze,P as q,ah as St,l as ue,L as $,O as $t,T as p,S as Q,a7 as z,z as Ae,F as te,j as Tt,aI as Ee,H as Re,ab as Pt,ac as It,s as Nt,an as Vt,Q as B,M as ae,U as se,aJ as Lt,W as Bt}from"./vendor/@vue-209dae6a.js";import{c as Ot,d as Mt}from"./vendor/pinia-d0b1b439.js";import{s as Ut}from"./vendor/pinia-plugin-persistedstate-ed167f96.js";import{a as W,r as N,u as H,E as D,e as Wt,j as qt,c as Y,f as ve,d as Dt,k as Ft,m as Se,h as M,n as fe,p as re,g as Kt,i as Qt,q as zt,s as jt,b as Ue,t as We,v as _e,w as Xt,x as Jt,y as de,z as Ht,A as je}from"./views/builder/index-b81f4e4a.js";import{N as $e}from"./vendor/nprogress-0a2c6fb0.js";import{E as Gt,c as Xe,b as G,i as Yt,z as Zt,e as en}from"./vendor/element-plus-2ce8f5a6.js";import{a as Je}from"./vendor/axios-a921b253.js";import{q as tn}from"./vendor/qs-8ba2d702.js";import{D as He}from"./vendor/dplayer-c0423fe2.js";import{e as nn}from"./vendor/echarts-02a375f3.js";import{l as on}from"./vendor/less-0b36eefe.js";import{N as ge}from"./vendor/@vicons-7419da81.js";import{Q as ye}from"./vendor/@element-plus-61f2bffa.js";import{Z as an,m as sn,T as cn,E as ln}from"./vendor/@wangeditor-788aa567.js";import{V as un}from"./vendor/vditor-7933e40d.js";import"./vendor/vue-demi-b27b5f21.js";import"./vendor/lodash-es-41619749.js";import"./vendor/@sxzz-c75af06c.js";import"./vendor/@ctrl-f8748455.js";import"./vendor/dayjs-be4529cb.js";import"./vendor/async-validator-dee29e8b.js";import"./vendor/memoize-one-297ddbcb.js";import"./vendor/normalize-wheel-es-ed76fb12.js";import"./vendor/@floating-ui-1ce37bfe.js";import"./vendor/side-channel-563153b6.js";import"./vendor/es-errors-c75f5a96.js";import"./vendor/object-inspect-0b216d8d.js";import"./vendor/side-channel-list-1349fdc5.js";import"./vendor/side-channel-map-4b712d1a.js";import"./vendor/get-intrinsic-50cfb5f2.js";import"./vendor/es-object-atoms-11ea1ab9.js";import"./vendor/math-intrinsics-9389030e.js";import"./vendor/gopd-30775706.js";import"./vendor/es-define-property-27915812.js";import"./vendor/has-symbols-76fb15e9.js";import"./vendor/get-proto-9c1ff8ae.js";import"./vendor/dunder-proto-a5399c94.js";import"./vendor/call-bind-apply-helpers-e4a24274.js";import"./vendor/function-bind-61637ca6.js";import"./vendor/hasown-20c58d17.js";import"./vendor/call-bound-c0bc6215.js";import"./vendor/side-channel-weakmap-9923858e.js";import"./vendor/tslib-54e39b60.js";import"./vendor/zrender-744c9c42.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}})();const Ge=e=>{let t=new Map;for(const n of e)if(n.menu_key){if(n.children&&n.children.length>0){const o=Ge(n.children);t=new Map([...t,...o])}t.set(`/${n.path}`,n.menu_key)}return t},rn=()=>{const e=Ce(),t=Ke(),n=le({active:""}),o=s=>{const c=Ge(e.menus).get(s)??"";n.active=c};return kt(()=>t.fullPath,()=>{o(t.path)}),{...At(n),updateActive:o}},[dn,mn]=xt(rn),js=()=>mn()??{active:C(""),updateActive:()=>{}},vn=T({__name:"App",setup(e){return dn(),(t,n)=>{const o=x("xb-view");return m(),O(o)}}}),Ye=Ot();Ye.use(Ut);$e.configure({easing:"ease",speed:500,showSpinner:!0,trickleSpeed:200,minimum:.3});const hn=async e=>{var o,s;const{siteInfo:t}=W(),n=((o=t==null?void 0:t.public_api)==null?void 0:o.layouts)??"";return e={...((s=N.currentRoute.value)==null?void 0:s.query)??{},...e},await H(n,e).then(a=>a.data)},be=C("OS"),we=matchMedia("(prefers-color-scheme: dark)"),he=()=>{we.matches?document.documentElement.dataset.theme="dark":document.documentElement.dataset.theme="light"};Et(()=>{be.value==="OS"?(we.addEventListener("change",he),he()):(document.documentElement.dataset.theme=be.value,we.removeEventListener("change",he))});function fn(){return{theme:be}}const _n={layoutMode:"",theme:"OS",isCollapse:!1,footerHeight:40,headerHeight:60,logoSize:40,sideMenuOrdinaryWidth:200,sideMenuCollapseWidth:64},gn=Mt("layout",()=>{const e=C({..._n});return{layoutInfo:e,getLayout:async a=>{a={layout:"sideBar",...a};const c=await hn(a);return c?(e.value=c,c):(D.confirm({type:"error",title:"温馨提示",message:"获取主题配置失败",showCancelButton:!1,confirmButtonText:"确定"}),Promise.reject("获取主题配置失败"))},setTheme:a=>{e.value.theme=a,fn().theme.value=a},setLayout:a=>{e.value.layoutMode=a},hanldCollapse:a=>{e.value.isCollapse=a}}});N.beforeEach(async(e,t,n)=>{var r;if($e.start(),e.path===Wt)return n();const o=W();if((r=o.siteInfo)!=null&&r.web_version||await o.getSite(),qt.includes(e.path))return n();const s=Y();if(!s.value&&e.path!==ve)return n({path:ve,query:{redirect:e.fullPath}});const a=xe();if(!a.userInfo&&s.value&&await a.getUserInfo(),s.value&&e.path===ve)return n({path:"/"});const c=Ce();if(c.menus.length===0&&s.value){await c.getMenus();const u=wt(c.menus);return pt(u),n({...e,replace:!0})}const i=gn();!i.layoutInfo.layoutMode&&s.value&&await i.getLayout(),n()});N.afterEach(e=>{var c;const{siteInfo:t}=W(),n=(t==null?void 0:t.web_name)||"积木云",o=(t==null?void 0:t.web_version)||"1.0.0",s=`${n} ${o}`;let a=(c=e.meta)!=null&&c.title?e.meta.title:n;a&&(a=`${a} - ${s}`),document.title=a,$e.done()});const yn=(e,t=0,n="_blank")=>{if(!e){Dt("缺少重定向地址","温馨提示");return}const o=/^http?:\/\//.test(e),s=/^https?:\/\//.test(e);if(o||s){window.open(e,n);return}const a=N.getRoutes().some(c=>c.path===e);t>0?Ft(`页面将在 ${t} 秒后跳转`,"温馨提示",{duration:t*1e3,onClose:()=>{a?N.push(e):window.open(e,n)}}):a?N.push(e):window.open(e,n)};D.on("EVENT:ROUTE",e=>{const t=e;N.push(t)});D.on("EVENT:NOTIFY",e=>{Gt(e)});D.on("EVENT:MESSAGE",e=>{Xe(e)});D.on("EVENT:CONFIRM",e=>{const{message:t}=e,n=e;G.confirm(t,n)});D.on("EVENT:REFRESH",e=>{const{refreshType:t,refreshToken:n}=e;console.log("Refresh token:",n,"Type:",t)});D.on("EVENT:REFRESH",()=>{N.push({path:"/redirect",query:{redirect:N.currentRoute.value.fullPath}})});D.on("EVENT:RELOAD",()=>{window.location.reload()});D.on("EVENT:KICKOUT",e=>{const{clearLoginOut:t}=xe();t(),Se((e==null?void 0:e.message)??"已踢出用户登录",(e==null?void 0:e.type)??"error",(e==null?void 0:e.title)??"温馨提示")});D.on("EVENT:REDIRECT",e=>{const{url:t,delay:n=0,target:o="_blank"}=e;yn(t,n,o)});function Te(e){e.use(Ye),e.use(N),e.use(Yt),window.vueApp=e}const bn="/backend/assets/static/png/play.b9bcc63d.png",wn="data:image/png;base64,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";function pn(){const e=C(null),t=C(null),n=C(0),o=C(0),s=C(0),a=C(!1);X(()=>{setTimeout(()=>{u()},200)});const c=f=>{u(),_()};function i(f){const d=Math.floor(f/60),b=f%60,k=String(d).padStart(2,"0"),E=String(b).padStart(2,"0");return`${k}:${E}`}const r=f=>{const d=t.value.getBoundingClientRect();let k=(f.clientX-d.left)/d.width,E=k*100;o.value=E;let V=k*e.value.duration;n.value=i(Math.floor(V)),e.value.currentTime=V,_()},u=()=>{var b,k,E;let f=((b=e.value)==null?void 0:b.currentTime)??0,d=isNaN(((k=e.value)==null?void 0:k.duration)??0)?0:((E=e.value)==null?void 0:E.duration)??0;n.value=i(Math.floor(f)),s.value=i(Math.floor(d)),o.value=Math.floor(f)/Math.floor(d)*100},_=f=>{if(!e.value)return a.value=!1,!1;e.value.paused?(e.value.play().catch(d=>{console.error(d)}),a.value=!0):(e.value.pause(),a.value=!1)};return{aduio:e,setbacksBox:t,currentTime:n,progress:o,duration:s,isPlay:a,handlePlay:_,handleBacks:r,handleTimeUpdate:u,handleCanPlay:c,handleEnd:()=>{_()}}}const Cn={class:"xb-audio"},xn={class:"audio-container flex justify-between"},kn={class:"flex-1"},An={class:"title"},En={class:"flex justify-between"},Rn={class:"mgl-6"},Sn={class:"play-btn"},$n=["src"],Tn=T({__name:"index",props:{title:{default:"未知音频"},url:{}},setup(e){const{aduio:t,setbacksBox:n,currentTime:o,progress:s,duration:a,isPlay:c,handlePlay:i,handleBacks:r,handleTimeUpdate:u,handleCanPlay:_,handleEnd:w}=pn();return(f,d)=>(m(),g("div",Cn,[h("div",xn,[h("div",kn,[h("div",An,I(f.title),1),h("div",En,[h("span",null,I(l(o)),1),h("span",Rn,I(l(a)),1)]),h("div",{class:"audio-setbacks",ref_key:"setbacksBox",ref:n,onClick:d[0]||(d[0]=(...b)=>l(r)&&l(r)(...b))},[h("i",{class:"audio-this-setbacks",style:Me({width:l(s)+"%"})},d[6]||(d[6]=[h("span",{class:"audio-backs-btn"},null,-1)]),4),h("span",{class:"audio-cache-setbacks",style:Me({width:l(s)+"%"})},null,4)],512)]),h("div",Sn,[l(c)?(m(),g("img",{key:1,src:wn,class:"play-icon",onClick:d[2]||(d[2]=(...b)=>l(i)&&l(i)(...b))})):(m(),g("img",{key:0,src:bn,class:"play-icon",onClick:d[1]||(d[1]=(...b)=>l(i)&&l(i)(...b))}))])]),h("audio",{ref_key:"aduio",ref:t,src:f.url,class:"custom-audio",onCanplay:d[3]||(d[3]=(...b)=>l(_)&&l(_)(...b)),onEnded:d[4]||(d[4]=(...b)=>l(w)&&l(w)(...b)),onTimeupdate:d[5]||(d[5]=(...b)=>l(u)&&l(u)(...b)),controls:""}," 您的浏览器不支持音频元素。 ",40,$n)]))}});const Ze=M(Tn,[["__scopeId","data-v-0cdd47dc"]]),Pn=()=>{var s,a,c,i;const e=Y(),t=W(),n=fe(((a=(s=t.siteInfo)==null?void 0:s.upload_api)==null?void 0:a.upload)??""),o=fe(((i=(c=t.siteInfo)==null?void 0:c.upload_api)==null?void 0:i.chunk)??"");return{context:{API_HOST:re,TOKEN:e.value,UPLOAD_FILE_API:n,UPLOAD_CHUNK_START_API:`${o}?_act=start`,UPLOAD_CHUNK_API:`${o}?_act=chunk`,UPLOAD_CHUNK_FINISH_API:`${o}?_act=finish`},data:{}}},et=(e,t,n)=>{Xe({message:e,type:t,...n})},In=(e,t)=>{Se(t,e,"温馨提示")},Nn=e=>{et(e,"温馨提示","info")},Vn=(e,t,n)=>A(e,t??"温馨提示","warning"),Ln=e=>{const t=`/${N.currentRoute.value.path}`;return(e.split("?")[0]??"")===t},Bn=(e,t)=>{if(e==="goBack")return N.back();if(t&&t.actionType==="url"){t.blank===!1?N.push(e):window.open(e);return}if(t&&e&&t.target){window.open(e,t.target);return}/^https?:\/\//.test(e)?N.replace(e):N.push(e)},On=(e,t)=>{if(e==="goBack")return N.go(-2);const n=N.currentRoute.value,o={pathname:n.path,hash:n.hash,query:n.query,search:`?${tn.stringify(n.query)}`},{normalizeLink:s}=window.amisRequire("amis-core");e=s(e,o),Kt(e.split("?")[1]||"")},Mn=e=>{e.baseURL=re,e.timeout=6e4,e.withCredentials=!0,e.headers=e.headers||{};const t=Y();e.headers.Authorization=t.value||"";const n=N.currentRoute.value.query||null;return n&&(e.params={...e.params,...n}),Je(e)},Un=e=>{e.url=`${re}${e.url}`;const t=Y();t.value&&(e.headers.Authorization=t.value)},Wn=(e,t,n,o,s)=>t,qn=()=>({notify:In,alert:Nn,confirm:Vn,jumpTo:Bn,isCurrentUrl:Ln,updateLocation:On,fetcher:Mn,requestAdaptor:Un,responseAdaptor:Wn,isCancel:e=>Je.isCancel(e)}),Dn=(e,t)=>{on.render(t).then(n=>{const o=document.createElement("style");o.setAttribute("id",e),o.setAttribute("type","text/css");const s=document.createTextNode(n.css);o.appendChild(s);const a=document.getElementsByTagName("head");a.length?a[0].appendChild(o):document.documentElement.appendChild(o)})},tt=(e,t,n=!1)=>{if(!document.querySelector(`style[id=${e}]`)){let o="";n?(o=`#${e} ${t}`,o=o.replace(`#${e}
`,`#${e}`)):o=t,Dn(e,o)}},Fn=`<template>
  <div class="template-container">\${content}</div>
</template>

<script>
export default {
  data() {
    return {}
  },
  methods: {},
}
<\/script>
`,qe=(e="")=>Fn.replace("${content}",e),nt=e=>{e||(e=qe("渲染错误，组件内容为空")),e.includes("<template>")||(e=qe(e));const t=Rt(e),{template:n,scriptSetup:o,script:s,styles:a}=t.descriptor,i=((o==null?void 0:o.content)??(s==null?void 0:s.content)??"").split("export default")??[],r=i[0]??"";let u=(i[1]??"").replaceAll("};","}");const _=`${r}
return ${u}`,w=new Function(_)();w.template=(n==null?void 0:n.content)??"";const f=(a==null?void 0:a.map(k=>k.content).join(`
`))??"",d=(a==null?void 0:a.map(k=>k.lang).join(`
`))??"",b=a==null?void 0:a.map(k=>k.scoped).toString();return w.style=f,w.styleLang=d,w.styleScoped=(b&&b==="true")??!1,w},Kn=(e,t,n)=>{const o=nt(t),s=ze(()=>new Promise(i=>{i(o)})),a=Qe(),c=ke(s,{...a,...n});return tt(e,o.style,o.styleScoped),Te(c),at(c,n),c.component(e,s),c.mount(`#${e}`),c},Qn=["id"],zn=T({__name:"render",props:{template:{},vars:{}},setup(e){const t=C(`xb-render-${Date.now()}`);return X(()=>Kn(t.value,e.template,e.vars)),(n,o)=>(m(),g("div",{id:l(t),class:"xb-render-component"},null,8,Qn))}});const jn=M(zn,[["__scopeId","data-v-b0f8a49d"]]),ot=T({__name:"index",props:{url:{},method:{},query:{},headers:{},vars:{}},setup(e){const t=C("");var n={};return Qt(e.url,e.method,e.query,e.headers).then(o=>{var c,i;const s=((c=o==null?void 0:o.data)==null?void 0:c.body[0].body)??"";t.value=s;const a=((i=o==null?void 0:o.data)==null?void 0:i.body[0].vars)??{};n={...e.vars,...a}}),(o,s)=>l(t)?(m(),O(jn,{key:0,template:l(t),vars:l(n)},null,8,["template","vars"])):q("",!0)}}),Z=(e,t={},n={})=>{const o={title:"常用模态框",draggable:!0,showClose:!1,closeOnClickModal:!1,showCancelButton:!0,showConfirmButton:!0,...n,message:()=>St(e,t)};return G(o),()=>{o==null||o.onVanish()}},Pe=async(e,t,n,o)=>Z(ot,{url:e,query:t,vars:{...n,onOpen:c=>{const i=c.url||"",r=c.vars||{},u=c.option||{};if(!i){A("远程组件地址不能为空","温馨提示","error");return}G.close(),Pe(i,r,u)},onClose:()=>{G.close()}}},{title:"远程组件模态框",customClass:"xb-render-modal",customStyle:{width:"50vw",height:"50vh"},draggable:!1,closeOnClickModal:!1,showClose:!0,showCancelButton:!1,showConfirmButton:!1,...o}),Xn=(e,t="温馨提示",n="",o)=>G.alert(e,{confirmButtonText:"确定",type:n,title:t,...o}),Jn=e=>{const t=xe(),n=W(),o=Ce(),s=zt(),a={get:H,post:Ue,put:We,delete:_e},c={token:t.getToken,userApp:t,siteApp:n,menuApp:o,moduleName:s,dplayer:He,echarts:nn,utils:jt,baseURL:re,axios:a,useGet:H,usePost:Ue,usePut:We,useDelete:_e,useAlert:Xn,useConfirm:A,useMessage:et,useNotify:Se,useLoading:Xt,useRemoteModal:Pe};e.config.globalProperties.$xbcode=c},Hn=(e,t)=>{const n=N.currentRoute.value.query;e.config.globalProperties.$route.query={...n,...t}},at=(e,t)=>{Hn(e,t),Jn(e),dt(e)},st=e=>(e!=null&&e._dialog&&delete e._dialog,e!=null&&e._replace&&delete e._replace,e),K=(e,t,n,o,s)=>{o=st(o);const a=ke(t,{...o,amis:n});return Te(a),at(a,s?o:{}),a==null||a.mount(e),a},ce=(e,t,n,o)=>{typeof t!="string"&&(t="该远程组件内容并非组件模板字符串");const s=e.id||`xb-${Date.now()}`;e.id=s;const a=nt(t),c=ze(()=>new Promise(i=>{i(a)}));return tt(e.id,a.style,a.styleScoped),o=st(o),K(e,c,n,o)};function ct(e){var r,u,_;const t=((r=e==null?void 0:e.$schema)==null?void 0:r.className)??"",n=((u=e==null?void 0:e.$schema)==null?void 0:u.height)??"auto",o=((_=e==null?void 0:e.$schema)==null?void 0:_.style)??{},s=(e==null?void 0:e.body)??"",a=(e==null?void 0:e.vars)??{},c=window.amisRequire("react");let i=c.useRef(null);return c.useEffect(function(){const w=ce(i.current,s,e,{...a,onClose:()=>{e.onAction({},{actionType:"reload",target:"crud"}),e.onAction({},{actionType:"close"})}});return()=>w.unmount()}),c.createElement("div",{ref:i,className:`xb-amis-component xb-amis-render-view ${t}`,style:{height:n,...o}})}function lt(e){var w,f,d,b,k,E,V;const t=((w=e==null?void 0:e.$schema)==null?void 0:w.url)??"",n=((f=e==null?void 0:e.$schema)==null?void 0:f.method)??"get",o=((d=e==null?void 0:e.$schema)==null?void 0:d.headers)??{},s=((b=e==null?void 0:e.$schema)==null?void 0:b.data)??{},a=((k=e==null?void 0:e.$schema)==null?void 0:k.height)??"auto",c=((E=e==null?void 0:e.$schema)==null?void 0:E.style)??{},i=((V=e==null?void 0:e.$schema)==null?void 0:V.className)??"",r=(e==null?void 0:e.vars)??{},u=window.amisRequire("react");let _=u.useRef(null);return u.useEffect(function(){var R;return t?(Jt({url:t,method:n,data:s,headers:o}).then(F=>{const J=(F==null?void 0:F.data)??"";R=ce(_.current,J,e,{...r,onClose:()=>{e.onAction({},{actionType:"reload",target:"crud"}),e.onAction({},{actionType:"close"})}})}).catch(()=>{R=ce(_.current,"渲染组件错误",e)}),()=>R==null?void 0:R.unmount()):(R=ce(_.current,"缺少远程组件地址",e),()=>R==null?void 0:R.unmount())}),u.createElement("div",{ref:_,className:`xb-amis-component xb-amis-remote-view ${i}`,style:{height:a,...c}})}const it=T({__name:"index",props:{icon:{},size:{default:18},color:{default:""}},setup(e){const t=ue(()=>{if(ye[e.icon])return ye[e.icon];if(ge[e.icon])return ge[e.icon]});return(n,o)=>{const s=x("el-icon");return m(),O(s,{size:n.size,color:n.color},{default:$(()=>[(m(),O($t(l(t))))]),_:1},8,["size","color"])}}});function ut(e){var _,w,f,d;const t=((_=e==null?void 0:e.$schema)==null?void 0:_.name)??"";let n=(e==null?void 0:e.data[t])??"";n||(n=((w=e==null?void 0:e.$schema)==null?void 0:w.value)??"");const o=(f=e==null?void 0:e.$schema)==null?void 0:f.size,s=(d=e==null?void 0:e.$schema)==null?void 0:d.color;delete e.$schema.icon,delete e.$schema.size,delete e.$schema.color;const a=(e==null?void 0:e.$schema)??{},c=window.amisRequire("react"),i=c.useRef(null),u=`xb-icons-${de()}`;return c.useEffect(function(){const b=K(i.current,it,e,{icon:n,size:o,color:s});return()=>b.unmount()}),c.createElement("div",{ref:i,id:u,...a})}const Gn={class:"xb-icon-list"},Yn={class:"tools"},Zn={class:"title"},eo={class:"options"},to={class:"list"},no=["onDblclick","onClick"],oo={class:"icon-title"},ao=T({__name:"modal",emits:["update:init"],setup(e,{expose:t,emit:n}){const o=Tt(),s=n,a=C("element"),c=C([{title:"ElementPlus",type:"element",icons:Object.keys(ye)},{title:"viconsAntd",type:"naiveui",icons:Object.keys(ge)}]),i=C(null),r=ue(()=>{var f;return((f=c.value.find(d=>d.type===a.value))==null?void 0:f.icons)||[]}),u=f=>{if(navigator.clipboard&&window.isSecureContext)navigator.clipboard.writeText(f).then(d=>{});else{const d=document.createElement("input");d.value=f,document.body.appendChild(d),d.select(),document.execCommand("Copy"),d.remove()}Ht("复制成功")},_=f=>{i.value=f},w=()=>i.value;return X(()=>{s("update:init",o.exposed)}),t({confirm:w}),(f,d)=>{var V;const b=x("el-option"),k=x("el-select"),E=x("xbIcons");return m(),g("div",Gn,[h("div",Yn,[h("div",Zn,I((V=l(c).find(R=>R.type===l(a)))==null?void 0:V.title)+" 图标库 ",1),h("div",eo,[p(k,{modelValue:l(a),"onUpdate:modelValue":d[0]||(d[0]=R=>Ae(a)?a.value=R:null)},{default:$(()=>[(m(!0),g(Q,null,z(l(c),(R,F)=>(m(),O(b,{key:F,label:R.title,value:R.type},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),h("div",to,[(m(!0),g(Q,null,z(l(r),(R,F)=>(m(),g("div",{key:F,class:te(["item",{active:R===l(i)}]),onDblclick:J=>u(R),onClick:J=>_(R)},[p(E,{icon:R,size:26,type:l(a),color:"#888"},null,8,["icon","type"]),h("div",oo,I(R),1)],42,no))),128))])])}}});const so=M(ao,[["__scopeId","data-v-dd1cee2c"]]),co=e=>new Promise((t,n)=>{const o=C(),s={"onUpdate:init":c=>{o.value=c}},a={...e,title:"图标选择器",customClass:"xb-icon-modal",beforeClose:(c,i,r)=>{var u;if(c==="confirm"){if(!((u=o.value)!=null&&u.confirm)){A("确认事件错误","温馨提示","error"),n(new Error("确认事件错误"));return}const _=o.value.confirm();if(!_){A("请选择图标","温馨提示","error"),n(new Error("请选择图标"));return}t(_)}r()}};Z(so,s,a)}),lo={key:1},io=T({__name:"picker",props:{amis:{}},setup(e){const t=e,n=()=>{co().then(o=>{t.amis.onChange(o,t.amis.name)})};return(o,s)=>{const a=x("xbIcons"),c=x("el-input");return m(),O(c,{placeholder:"请选择图标",onClick:n,value:o.amis.value,readonly:""},{prepend:$(()=>[o.amis.value?(m(),O(a,{key:0,icon:o.amis.value},null,8,["icon"])):(m(),g("span",lo,"无"))]),_:1},8,["value"])}}});function uo(e){const t=(e==null?void 0:e.value)||"",n=window.amisRequire("react"),o=n.useRef(null);return n.useEffect(()=>{const s=K(o.current,io,e,{value:t});return()=>s.unmount()}),n.createElement("div",{ref:o})}const ro={class:"xb-layout-count"},De=24,mo=T({__name:"index",props:{col:{},counts:{}},setup(e){Ee(o=>({"2248ff0c":De,"224801b6":l(n)}));const n=parseInt((De/e.col).toString());return(o,s)=>{const a=x("el-statistic");return m(),g("div",ro,[(m(!0),g(Q,null,z(o.counts,(c,i)=>(m(),O(a,Re({class:"item",key:i,ref_for:!0},c),null,16))),128))])}}});const vo=M(mo,[["__scopeId","data-v-43536123"]]);function ho(e){var c,i;const t={...(e==null?void 0:e.$schema)??{}},n=(t==null?void 0:t.col)??8,o=(t==null?void 0:t.list)??[];(c=e==null?void 0:e.$schema)!=null&&c.col&&delete e.$schema.col,(i=e==null?void 0:e.$schema)!=null&&i.list&&delete e.$schema.list;const s=window.amisRequire("react"),a=s.useRef(null);return s.useEffect(function(){const r=K(a.current,vo,e,{col:n,counts:o});return()=>r.unmount()}),s.createElement("div",{ref:a,...t})}const fo={class:"xb-layout-prompt"},_o=["innerHTML"],go=T({__name:"index",props:{content:{},alert:{}},setup(e){return(t,n)=>{const o=x("el-alert");return m(),g("div",fo,[p(o,Pt(It(t.alert)),{default:$(()=>[h("div",{innerHTML:t.content},null,8,_o)]),_:1},16)])}}});const yo=M(go,[["__scopeId","data-v-705ce2bc"]]);function bo(e){var c,i,r;const t=((i=(c=e==null?void 0:e.$schema)==null?void 0:c.props)==null?void 0:i.content)??"",n={...((r=e==null?void 0:e.$schema)==null?void 0:r.props)??{}};delete n.content;const o=(e==null?void 0:e.$schema)??{},s=window.amisRequire("react"),a=s.useRef(null);return s.useEffect(function(){const u=K(a.current,yo,e,{content:t,alert:n});return()=>u.unmount()}),s.createElement("div",{ref:a,...o})}const wo={class:"xb-layout-tabs"},po=["onClick"],Co=T({__name:"index",props:{field:{},items:{}},setup(e){const t=e,n=Ke(),o=Ct(),s=C(n.query[t.field]||""),a=c=>{o.push({query:{...n.query,[t.field]:c.value}})};return(c,i)=>(m(),g("div",wo,[(m(!0),g(Q,null,z(c.items,(r,u)=>(m(),g("div",{class:te(["item",{active:l(s)===r.value}]),key:u,onClick:_=>a(r)},I(r.label),11,po))),128))]))}});const xo=M(Co,[["__scopeId","data-v-96be4d1d"]]);function ko(e){var c,i;const t=((c=e==null?void 0:e.$schema)==null?void 0:c.field)??"",n=((i=e==null?void 0:e.$schema)==null?void 0:i.items)??[],o=(e==null?void 0:e.$schema)??{},s=window.amisRequire("react"),a=s.useRef(null);return s.useEffect(function(){const r=K(a.current,xo,e,{field:t,items:n});return()=>r.unmount()}),s.createElement("div",{ref:a,...o})}const Ao=()=>{var s,a;const e=Y(),{siteInfo:t}=W(),n=C(),o=C({MENU_CONF:{uploadImage:{headers:{Authorization:`Bearer ${e.value}`},allowedFileTypes:["image/*"],server:((s=t==null?void 0:t.editor_upload_api)==null?void 0:s.image)??"Upload/image"},uploadVideo:{headers:{Authorization:`Bearer ${e.value}`},allowedFileTypes:["video/*"],server:((a=t==null?void 0:t.editor_upload_api)==null?void 0:a.video)??"Upload/video"}}});return{toolbarConfig:n,editorConfig:o}},Eo={class:"wangedit-container"},Ro=T({__name:"index",props:{value:{},options:{},amis:{}},emits:["value"],setup(e,{emit:t}){Ee(f=>({"1fd4a862":l(a)})),an.registerModule(sn);const n=t,o=Nt(),s=C(e.value||""),a=ue(()=>{var f,d,b,k,E,V;return(f=e.options)!=null&&f.height&&typeof((d=e.options)==null?void 0:d.height)=="string"?(b=e.options)==null?void 0:b.height:(k=e.options)!=null&&k.height&&typeof((E=e.options)==null?void 0:E.height)=="number"?`${(V=e.options)==null?void 0:V.height}px`:"500px"}),c=f=>{const d=f.getHtml();n("value",d)},{toolbarConfig:i,editorConfig:r}=Ao(),_={onCreated:f=>{f.getAllMenuKeys().includes("uploadify"),o.value=f},onChange:c},w={defaultConfig:r.value,mode:"default",...e.options||{}};return(f,d)=>(m(),g("div",Eo,[p(l(cn),{class:"toolbar",editor:l(o),defaultConfig:l(i)},null,8,["editor","defaultConfig"]),p(l(ln),Re({class:"content",modelValue:l(s),"onUpdate:modelValue":d[0]||(d[0]=b=>Ae(s)?s.value=b:null)},w,Vt(_)),null,16,["modelValue"])]))}});const So=M(Ro,[["__scopeId","data-v-d208b3bc"]]);function $o(e){var r,u;const t=((r=e==null?void 0:e.$schema)==null?void 0:r.options)??{},n=(e==null?void 0:e.value)??"";(u=e.$schema)==null||delete u.options;const o=(e==null?void 0:e.$schema)??{},s=window.amisRequire("react"),a=s.useRef(null),i=`xb-wangEditor-${de()}`;return s.useEffect(function(){const _=K(a.current,So,e,{value:n,options:t});return()=>_==null?void 0:_.unmount()}),s.createElement("div",{ref:a,id:i,...o})}const To=[{label:"图片",value:"image",icon:"",ext:["jpg","jpeg","png","gif","webp","svg"]},{label:"音频",value:"audio",icon:"",ext:["mp3","wav","ogg","flac"]},{label:"视频",value:"video",icon:"",ext:["mp4","avi","mov","wmv","flv"]},{label:"文件",value:"file",icon:"",ext:[]}],Po=["image","video","audio","file"],Io=["jpg","jpeg","png","gif","webp","svg"],No=["mp4","avi","mov","wmv","flv"],Vo=["mp3","wav","ogg","flac"],ie=e=>{var n,o;const t=((o=(n=e.split(".").pop())==null?void 0:n.toLowerCase().split("?"))==null?void 0:o.shift())||"";return Io.includes(t)?"image":Vo.includes(t)?"audio":No.includes(t)?"video":"file"},Lo=(e,t="播放音频")=>{if(!e){A("音频地址为空，无法播放","温馨提示","error",{showCancelButton:!1});return}if(!je(e)){A("音频地址不合法，无法播放","温馨提示","error",{showCancelButton:!1});return}const n=e.toLowerCase();if(!n.endsWith(".mp3")&&!n.endsWith(".ogg")&&!n.endsWith(".wav")){A("音频必须是 mp3,ogg,wav 格式","温馨提示","error",{showCancelButton:!1});return}Z(Ze,{title:t,url:e},{title:t,showClose:!0,customClass:"xb-render-modal",customStyle:{width:"400px",height:"200px"}})},Bo={class:"xb-video"},Oo=T({__name:"index",props:{title:{},url:{}},setup(e){const t=e,n=Qe(),o=C({...n,video:{url:t.url}});return X(()=>{const s=document.getElementById("dplayer");new He({container:s,...o.value})}),(s,a)=>(m(),g("div",Bo,a[0]||(a[0]=[h("div",{id:"dplayer"},null,-1)])))}});const rt=M(Oo,[["__scopeId","data-v-0891e70e"]]),Mo=(e,t="播放视频")=>{if(!e){A("视频地址为空，无法播放","温馨提示","error",{showCancelButton:!1});return}if(!je(e)){A("视频地址不合法，无法播放","温馨提示","error",{showCancelButton:!1});return}const n=e.toLowerCase();if(!n.endsWith(".mp4")&&!n.endsWith(".ogg")&&!n.endsWith(".webm")){A("视频必须是 mp4,ogg,webm 格式","温馨提示","error",{showCancelButton:!1});return}Z(rt,{title:t,url:e},{title:t,showClose:!0,customClass:"xb-render-modal",customStyle:{width:"600px",height:"450px"}})},Uo={class:"preview"},Wo={key:1,class:"xb-audio"},qo={key:2,class:"xb-video"},Do={key:3,class:"xb-file"},Fo={class:"mask"},Ko=T({__name:"preview",props:{value:{},type:{},size:{default:"7.5rem"},viewText:{default:"预览"},viewIcon:{default:"View"},delText:{default:"移除"},delIcon:{default:"Close"}},emits:["remove"],setup(e,{emit:t}){Ee(c=>({"307b317f":c.size}));const n=t,o=C(),s=()=>{var c;switch(e.type){case"image":(c=o.value)==null||c.showPreview();break;case"audio":Lo(e.value);break;case"video":Mo(e.value);break}},a=()=>{n("remove",e.value)};return(c,i)=>{const r=x("el-image"),u=x("xbIcons");return m(),g("div",Uo,[c.type==="image"?(m(),O(r,{key:0,class:"xb-image",ref_key:"imageRef",ref:o,fit:"cover",src:c.value,"preview-src-list":[c.value]},{default:$(()=>i[0]||(i[0]=[B(" 加载失败 ")])),_:1},8,["src","preview-src-list"])):c.type==="audio"?(m(),g("div",Wo,[p(u,{icon:"Headset",size:20}),i[1]||(i[1]=h("div",{class:"text"},"音频文件",-1))])):c.type==="video"?(m(),g("div",qo,[p(u,{icon:"VideoPlay",size:20}),i[2]||(i[2]=h("div",{class:"text"},"视频文件",-1))])):(m(),g("div",Do,[p(u,{icon:"Headset",size:20}),i[3]||(i[3]=h("div",{class:"text"},"文件类型",-1))])),h("div",Fo,[c.type!=="file"?(m(),g("div",{key:0,class:"item",onClick:s},[p(u,{icon:c.viewIcon,size:18},null,8,["icon"]),h("span",null,I(c.viewText),1)])):q("",!0),h("div",{class:"item",onClick:a},[p(u,{icon:c.delIcon,size:18},null,8,["icon"]),h("div",null,I(c.delText),1)])])])}}});const pe=M(Ko,[["__scopeId","data-v-a2f87da9"]]),Fe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAACJElEQVRYR+2YMWsUURSFz3m7s+nskjUIQSutbMRi7WzUVjSadMHCbVLkByjmLygaCVYWRqMEUhkFS9Gg0cJfYCPZjYUQFbPs+I7c2R1Q2ZjZfRNYYS4MAzPv3vnmvDvL3kMA2Hl5/CjLI9ckf4ZwY3Zt15C+gfwIao3So0rt3XsJtPUk9M/cAW6y9ap2DIyfAjgCwANwGeoYiEFtk/5e5CvXeer1D2neATcGgiTZM4+t9RNLEKcBtAFEGeBsiRWzl7EoSXo+8rV9gWc/fDc1B1VSEoEnDpj0KTB33tS26DGaEezvZQZpRxmODyoT5+vwBwS3zeTcT4yjTdZNJEiPSykk1bjZX6HeD/WQJ1zUApgq2w+etcsniBuAVlH9vELOx6Yo1VywgkmTB4X1kEGGhyAtg/Ecq3NNqnknDwVTrNBaactEts88OHs5b8Bw/Tof4M+kr4WrwwhoL9n5uRPWhxWwsxPEl+EGNMacP5I8evCPGgVgqKSFgoWCoQqE5hc9WCgYqkBoftGDeSiYz1/+UJLe+foftvh2A2B1fwQIrapkaFoDcK4PVyH0qVnyU4fjGdW4NQ2WlgDE5hLkMoJmQdh9zW9Dk59K5lhtLjyE01TX/jDILP5MGEbvbFPOJroIXvc5PjvTBbx7GM4vAjjd9WdSc2g/IPaqaTv5Aq58haP1TSb2Au20GGErvgTxIqiTAA7tVSnn+2Z9vAXdCsa4bD6Nsf0C/gYA5PMzcW0AAAAASUVORK5CYII=",Qo={class:"attachment-modal-container"},zo={class:"xb-tab-content"},jo={class:"category"},Xo={class:"title"},Jo=["onClick"],Ho={class:"title"},Go={class:"text"},Yo={class:"action"},Zo={class:"body"},ea={class:"header"},ta={class:"description"},na={class:"count"},oa={class:"count"},aa={class:"actions"},sa={key:0,class:"content"},ca=["onClick"],la={class:"title"},ia={key:1,class:"empty"},ua={class:"footer"},ra={class:"paginate"},da={class:"action"},ma=T({__name:"modal",props:{selectLimit:{default:1},uploadLimit:{default:1}},emits:["confirm","close"],setup(e,{emit:t}){const n=t,{active:o,isAdmin:s,adminSelected:a,normalSelected:c,categoryActive:i,category:r,datalist:u,pageSize:_,page:w,total:f,getCategory:d,hanldChangeAdmin:b,hanldChangeType:k,hanldCategory:E,hanldCategoryAdd:V,hanldCategoryEdit:R,hanldCategoryDel:F,hanldUpload:J,hanldSelect:Ne,hanldSelectAll:Ve,hanldRemove:Le}=ya(e.selectLimit,e.uploadLimit),Be=()=>{n("confirm",c.value)},Oe=()=>{c.value=[],a.value=[],s.value=!1,n("close")};return X(()=>{d().catch(y=>{A((y==null?void 0:y.message)||"获取分类失败，请稍后再试！","温馨提示","error",{showCancelButton:!1}).then(()=>{n("close")})})}),(y,v)=>{const P=x("el-image"),S=x("xbIcons"),L=x("el-dropdown-item"),ee=x("el-dropdown-menu"),ne=x("el-dropdown"),j=x("el-button"),mt=x("el-col"),vt=x("el-row"),ht=x("el-empty"),ft=x("el-pagination"),_t=x("el-tab-pane"),gt=x("el-tabs");return m(),g("div",Qo,[p(gt,{modelValue:l(o),"onUpdate:modelValue":v[2]||(v[2]=oe=>Ae(o)?o.value=oe:null),onTabChange:l(k),class:"attachment-tabs"},{default:$(()=>[(m(!0),g(Q,null,z(l(To),(oe,yt)=>(m(),O(_t,{label:oe.label,name:oe.value,key:yt},{default:$(()=>[h("div",zo,[h("div",jo,[h("div",{class:te(["item",{active:l(i)===""}]),onClick:v[1]||(v[1]=U=>l(E)(""))},[h("div",Xo,[p(P,{class:"icon",src:l(Fe)},null,8,["src"]),v[3]||(v[3]=h("span",{class:"text"},"全部",-1))]),h("div",{class:"action",onClick:v[0]||(v[0]=(...U)=>l(V)&&l(V)(...U))},"添加")],2),(m(!0),g(Q,null,z(l(r),(U,me)=>(m(),g("div",{class:te(["item",{active:l(i)===U.value}]),key:me,onClick:bt=>l(E)(U.value)},[h("div",Ho,[p(P,{class:"icon",src:l(Fe)},null,8,["src"]),h("span",Go,I(U.label),1)]),h("div",Yo,[p(ne,{placement:"bottom-end"},{dropdown:$(()=>[p(ee,null,{default:$(()=>[p(L,null,{default:$(()=>v[4]||(v[4]=[B("修改")])),_:1}),p(L,null,{default:$(()=>v[5]||(v[5]=[B("删除")])),_:1})]),_:1})]),default:$(()=>[p(S,{icon:"More"})]),_:1})])],10,Jo))),128))]),h("div",Zo,[h("div",ea,[ae(h("div",ta,[v[6]||(v[6]=B(" 最多可以选择 ")),h("span",na,I(y.selectLimit),1),v[7]||(v[7]=B(" 个，已选择 ")),h("span",oa,I(l(s)?l(a).length:l(c).length),1),v[8]||(v[8]=B(" 个 "))],512),[[se,l(s)===!1]]),h("div",aa,[p(j,{type:"success",onClick:l(J)},{default:$(()=>v[9]||(v[9]=[B("上传")])),_:1},8,["onClick"]),ae(p(j,{type:"danger"},{default:$(()=>v[10]||(v[10]=[B("删除")])),_:1},512),[[se,l(s)]]),ae(p(j,{type:"warning"},{default:$(()=>v[11]||(v[11]=[B("移动")])),_:1},512),[[se,l(s)]]),ae(p(j,{type:"info",onClick:l(Ve)},{default:$(()=>v[12]||(v[12]=[B("全选")])),_:1},8,["onClick"]),[[se,l(s)]]),p(j,{type:"primary",onClick:l(b)},{default:$(()=>[B(I(l(s)?"退出":"管理"),1)]),_:1},8,["onClick"])])]),l(u).length?(m(),g("div",sa,[p(vt,{gutter:20},{default:$(()=>[(m(!0),g(Q,null,z(l(u),(U,me)=>(m(),O(mt,{span:4,key:me},{default:$(()=>[h("div",{class:te(["attachment",{"normal-active":l(c).includes(U.url),"admin-active":l(a).includes(U.url)}]),onClick:bt=>l(Ne)(U.url)},[p(pe,{"del-icon":"Delete","del-text":"删除",size:"100%",value:U.url,type:l(ie)(U.url),onRemove:l(Le)},null,8,["value","type","onRemove"]),h("div",la,I(U.title),1)],10,ca)]),_:2},1024))),128))]),_:2},1024)])):(m(),g("div",ia,[p(ht,{description:"当前没有更多的附件"})])),h("div",ua,[h("div",ra,[p(ft,{background:"",layout:"prev, pager, next, jumper, total",total:l(f),"default-page-size":l(_),"default-current-page":l(w)},null,8,["total","default-page-size","default-current-page"])]),h("div",da,[p(j,{type:"primary",disabled:!l(c).length,onClick:Be},{default:$(()=>v[13]||(v[13]=[B(" 确定选择 ")])),_:1},8,["disabled"]),p(j,{type:"danger",onClick:Oe},{default:$(()=>v[14]||(v[14]=[B(" 关闭窗口 ")])),_:1})])])])])]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue","onTabChange"])])}}});const va=M(ma,[["__scopeId","data-v-84cba765"]]),ha={class:"upload-container"},fa=T({__name:"upload",props:{uploadLimit:{}},setup(e){var o;const{siteInfo:t}=W(),n=le({action:((o=t==null?void 0:t.upload_api)==null?void 0:o.upload)||"",limit:e.uploadLimit});return(s,a)=>{const c=x("xbIcons"),i=x("el-upload");return m(),g("div",ha,[p(i,Re({class:"upload"},l(n),{drag:"",multiple:""}),{default:$(()=>[p(c,{icon:"UploadFilled "}),a[0]||(a[0]=h("div",{class:"el-upload__text"},[B(" 将文件拖放到此处或 "),h("em",null,"单击上传")],-1))]),_:1},16)])}}});const _a=M(fa,[["__scopeId","data-v-bac74bf7"]]),ga=(e={},t)=>new Promise((n,o)=>{Z(va,{...e,onConfirm:s=>{n(s)},onClose:()=>{G.close()}},{title:"附件管理器",customClass:"xb-render-modal",customStyle:{width:"60vw",height:"70vh"},draggable:!1,closeOnClickModal:!1,showClose:!1,showCancelButton:!1,showConfirmButton:!1,...t})}),ya=(e,t)=>{const{siteInfo:n}=W(),o=C("image"),s=C(!1),a=C([]),c=C([]),i=C(""),r=C([]),u=C([]),_=C(30),w=C(1),f=C(0),d=()=>{c.value=[],a.value=[],s.value=!s.value},b=y=>{if(!Po.includes(y)){A("不支持的附件类型","温馨提示","error",{showCancelButton:!1});return}c.value=[],a.value=[],i.value="",o.value=y,V()},k=y=>{i.value=y,y===""?(c.value=[],a.value=[]):u.value=u.value.filter(v=>ie(v.url)===y)},E=()=>{var P;const y=((P=n==null?void 0:n.upload_api)==null?void 0:P.index)||"";if(!y)return A("未配置附件列表接口","温馨提示","error",{showCancelButton:!1}),Promise.reject(new Error("未配置附件列表接口"));const v={type:o.value,page:w.value,limit:_.value,cid:i.value,_act:1};H(y,v).then(S=>{var L;if(S.status===0){const ee=((L=S.data)==null?void 0:L.items)||[];u.value=ee}else A(S.msg||"获取分类失败","温馨提示","error")})},V=async()=>new Promise((y,v)=>{var S;const P=((S=n==null?void 0:n.upload_cate_api)==null?void 0:S.index)||"";if(!P){A("未配置附件分类接口","温馨提示","error",{showCancelButton:!1}).then(()=>{v(new Error("未配置附件分类接口"))});return}H(P,{type:o.value}).then(L=>{if(L.status===0){const ee=(L==null?void 0:L.data)||[];r.value=ee.map(ne=>({label:ne.name,value:ne.id})),E(),y(L.data)}else A(L.msg||"获取分类列表失败","温馨提示","error").then(()=>{v(new Error(L.msg||"获取分类失败"))})}).catch(L=>{v(new Error((L==null?void 0:L.message)||"获取分类失败"))})});return{active:o,isAdmin:s,adminSelected:a,normalSelected:c,categoryActive:i,category:r,datalist:u,pageSize:_,page:w,total:f,getCategory:V,getAttachment:E,hanldChangeAdmin:d,hanldChangeType:b,hanldCategory:k,hanldCategoryAdd:()=>{var y;(y=n==null?void 0:n.upload_cate_api)!=null&&y.add},hanldCategoryEdit:y=>{var P;const v=((P=n==null?void 0:n.upload_cate_api)==null?void 0:P.edit)||"";Pe(v,{id:y},{},{title:"修改分类",customStyle:{width:"600px",height:"400px"}})},hanldCategoryDel:y=>{A("确定删除该分类吗？","温馨提示","error").then(()=>{var P;const v=((P=n==null?void 0:n.upload_cate_api)==null?void 0:P.del)||"";_e(v,{id:y}).then(S=>{S.status===0?(A((S==null?void 0:S.msg)||"操作失败","温馨提示","success"),V()):A(S.msg||"删除失败","温馨提示","error")}).catch(S=>{A((S==null?void 0:S.message)||"删除失败","温馨提示","error")})})},hanldUpload:()=>{const y=Z(_a,{uploadLimit:t,onClose:()=>{y()}},{title:"文件上传",customClass:"xb-modal",customStyle:{width:"60vw",height:"70vh"},draggable:!1,closeOnClickModal:!1,showClose:!0,showCancelButton:!1,showConfirmButton:!0})},hanldSelect:y=>{if(s.value){const v=a.value.indexOf(y);v===-1?a.value.push(y):a.value.splice(v,1)}else{if(e<=1){c.value[0]=y;return}const v=c.value.indexOf(y);v===-1||c.value.splice(v,1),c.value.push(y)}},hanldSelectAll:()=>{s.value?a.value.length===u.value.length?a.value=[]:a.value=u.value.map(y=>y.url):c.value.length===u.value.length?c.value=[]:c.value=u.value.map(y=>y.url)},hanldSelectMove:()=>{var P;const y=((P=n==null?void 0:n.upload_api)==null?void 0:P.move)||"";if(!y)return A("未配置附件移动接口","温馨提示","error",{showCancelButton:!1}),Promise.reject(new Error("未配置附件移动接口"));const v=c.value.join(",");return H(y,{ids:v}).then(S=>{S.status===0?(A(S.msg||"移动成功","温馨提示","success"),E()):A(S.msg||"移动失败","温馨提示","error")}).catch(S=>{A(S.message||"移动失败","温馨提示","error")})},hanldRemove:y=>{const v=u.value.findIndex(P=>P.url===y);v!==-1&&u.value.splice(v,1)}}},ba={class:"attachment-container"},wa={key:0,class:"preview-container"},pa={class:"xb-preview"},Ca={class:"text"},xa=T({__name:"index",props:{value:{},text:{default:"选择"},icon:{default:"Plus"},selectLimit:{default:1},uploadLimit:{default:1},amis:{}},setup(e){const t=()=>{const o={selectLimit:e.selectLimit,uploadLimit:e.uploadLimit};ga(o).then(s=>{console.log("value",e.value)})},n=o=>{if(Array.isArray(e.value)){const s=e.value.findIndex(a=>a===o);s>-1&&e.value.splice(s,1),e.amis.onChange(e.value,e.amis.name)}else e.amis.onChange("",e.amis.name)};return(o,s)=>{const a=x("xbIcons");return m(),g("div",ba,[o.value?(m(),g("div",wa,[h("div",pa,[Array.isArray(o.value)?(m(!0),g(Q,{key:0},z(o.value,(c,i)=>(m(),O(pe,{class:"item",key:i,value:c,type:l(ie)(c),onRemove:n},null,8,["value","type"]))),128)):(m(),O(pe,{key:1,class:"item",value:o.value,type:l(ie)(o.value),onRemove:n},null,8,["value","type"]))])])):q("",!0),Array.isArray(o.value)&&o.selectLimit>o.value.length||!o.value?(m(),g("div",{key:1,class:"upload-button",onClick:t},[p(a,{icon:o.icon,size:22},null,8,["icon"]),h("div",Ca,I(o.text),1)])):q("",!0)])}}});const ka=M(xa,[["__scopeId","data-v-3a747ffc"]]);function Aa(e){var _,w,f,d,b,k;(_=e==null?void 0:e.$schema)==null||_.name;const t=(w=e==null?void 0:e.$schema)==null?void 0:w.text,n=(f=e==null?void 0:e.$schema)==null?void 0:f.icon,o=(d=e==null?void 0:e.$schema)==null?void 0:d.limit;var s=(e==null?void 0:e.value)||"";(b=e.$schema)==null||delete b.value,(k=e.$schema)==null||delete k.options;const a=(e==null?void 0:e.$schema)??{},c=window.amisRequire("react"),i=c.useRef(null),u=`xb-attachment-${de()}`;return c.useEffect(function(){const E=K(i.current,ka,e,{value:s,text:t,icon:n,limit:o});return()=>E==null?void 0:E.unmount()}),c.createElement("div",{ref:i,id:u,...a})}const Ea={id:"vsitor"},Ra=T({__name:"index",props:{value:{},options:{}},setup(e){const t=Y(),{siteInfo:n}=W(),o=C(null);return X(()=>{var a;const s=fe(((a=n==null?void 0:n.upload_api)==null?void 0:a.upload)||"");o.value=new un("vsitor",{mode:"sv",preview:{mode:"both"},...e.options||{},value:e.value,upload:{url:s,linkToImgUrl:s,multiple:!1,fieldName:"file",headers:{Authorization:t.value||""},format:(c,i)=>{var u;const r=JSON.parse(i);return(u=r==null?void 0:r.data)!=null&&u.url?JSON.stringify({msg:"",code:0,data:{errFiles:[],succMap:{"file.jpg":r.data.url}}}):(A("上传失败","温馨提示","error"),JSON.stringify({msg:"上传失败",code:404,data:{}}))}},toolbarConfig:{pin:!0},cache:{enable:!1}})}),(s,a)=>(m(),g("div",Ea))}});function Sa(e){var r,u,_;const t=((r=e==null?void 0:e.$schema)==null?void 0:r.options)??{},n=(e==null?void 0:e.value)??"";(u=e.$schema)==null||delete u.value,(_=e.$schema)==null||delete _.options;const o=(e==null?void 0:e.$schema)??{},s=window.amisRequire("react"),a=s.useRef(null),i=`xb-vditor-${de()}`;return s.useEffect(function(){const w=K(a.current,Ra,e,{value:n,options:t});return()=>w==null?void 0:w.unmount()}),s.createElement("div",{ref:a,id:i,...o})}const $a={xbRender:ct,xbRemote:lt,xbIcons:ut,xbCount:ho,xbPrompt:bo,xbTabs:ko},Ta={xbVditor:Sa,xbFormIcon:ut,xbWangEditor:$o,xbFormRemote:lt,xbFormRender:ct,xbAttachment:Aa,xbIconsPicker:uo},Pa=()=>{const e=window.amisRequire("amis");Object.entries($a).forEach(([t,n])=>{e.Renderer({name:"static",test:new RegExp(`(^|/)${t}$`)})(n)}),Object.entries(Ta).forEach(([t,n])=>{e.FormItem({name:"static",test:new RegExp(`(^|/)${t}$`)})(n)})};function Ia(e,t){const n=document.createElement("script");n.setAttribute("type","text/javascript"),n.setAttribute("src",e),n.onload=()=>t(),n.onerror=()=>t(new Error(`Failed to load ${e}`)),document.body.appendChild(n)}function Na(e){for(const t of e){const n=document.createElement("link");n.setAttribute("rel","stylesheet"),n.setAttribute("type","text/css"),n.setAttribute("href",t),document.head.insertBefore(n,document.head.firstChild)}}function Va(){return new Promise((e,t)=>{if(window.amisRequire){e(new Error("SDK already loaded"));return}const n="backend",o="assets/amis",a=["sdk.css","helper.css","iconfont.css","theme/default.css"].map(c=>`/${n}/${o}/${c}`);Na(a),Ia(`/${n}/${o}/sdk.js`,c=>{if(c){t(c);return}e("SDK loaded successfully")})})}const La={ref:"amis-render",style:{position:"relative",overflow:"hidden"}},Ba=T({__name:"index",props:{schema:{}},emits:["ready"],setup(e,{emit:t}){const n=t,o=Lt("amis-render"),s=C(null),a=async()=>{await Va();const c=window.amisRequire("amis/embed");Pa();const i=c.embed(o.value,e.schema,Pn(),qn(),()=>{n("ready",{instance:i})});s.value=i,n("ready",s.value)};return X(()=>a()),Bt(()=>{var c;(c=s.value)==null||c.unmount()}),(c,i)=>(m(),g("div",La,null,512))}}),Oa={key:0,class:"copyright"},Ma=["href"],Ua=["href"],Wa=T({__name:"index",setup(e){const{siteInfo:t}=W(),n=t==null?void 0:t.about_name,o=t==null?void 0:t.about_url,s=t==null?void 0:t.web_name,a=t==null?void 0:t.web_url,c=t==null?void 0:t.web_version;return(i,r)=>l(n)&&l(o)&&l(s)&&l(a)?(m(),g("div",Oa,[r[0]||(r[0]=B(" copyright © 2023-2025 ")),l(n)&&l(o)?(m(),g("a",{key:0,href:`${l(o)}`,target:"_blank",class:"pl-10px"},I(l(n)),9,Ma)):q("",!0),r[1]||(r[1]=B(" All Rights Reserved ")),l(s)&&l(a)?(m(),g("a",{key:1,href:`${l(a)}`,target:"_blank",class:"pl-10px"},I(l(s))+" "+I(l(c)),9,Ua)):q("",!0)])):q("",!0)}});const qa=M(Wa,[["__scopeId","data-v-d1fb9013"]]),Da="/backend/assets/static/png/beian.gov.a20583c8.png",Fa={key:0,class:"beian-pro"},Ka="http://beian.miit.gov.cn/",Qa=T({__name:"beian",setup(e){const{siteInfo:t}=W(),n=`http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=${t==null?void 0:t.web_police_code}`;return(o,s)=>{var c,i,r,u,_,w,f;const a=x("el-image");return(c=l(t))!=null&&c.web_icp||(i=l(t))!=null&&i.web_police?(m(),g("div",Fa,[(r=l(t))!=null&&r.web_icp?(m(),g("a",{key:0,class:"item",href:Ka,target:"_blank"},I((u=l(t))==null?void 0:u.web_icp),1)):q("",!0),(_=l(t))!=null&&_.web_police&&((w=l(t))!=null&&w.web_police_code)?(m(),g("a",{key:1,class:"item",href:n,target:"_blank"},[p(a,{class:"beian-gov",src:l(Da)},null,8,["src"]),h("span",null,I((f=l(t))==null?void 0:f.web_police),1)])):q("",!0)])):q("",!0)}}});const za=M(Qa,[["__scopeId","data-v-c50d0d7e"]]),ja="www.xbcode.net",Xa=()=>{var n;const e=(n=document.getElementById("xbcode-link"))==null?void 0:n.getAttribute("href");return!e||e.replace(/https?:\/\//,"").replace(/\/$/,"")!==ja},Ja={key:0,class:"empty"},Ha=T({__name:"index",setup(e){const t=C("zh-cn"),n=ue(()=>t.value==="zh-cn"?Zt:en),o=le({autoInsertSpace:!1}),s=le({max:1}),a=Xa();return(c,i)=>{const r=x("el-empty"),u=x("router-view"),_=x("el-config-provider");return m(),O(_,{button:l(o),message:l(s),locale:l(n)},{default:$(()=>[l(a)?(m(),g("div",Ja,[p(r,{description:"异常错误，非法使用"})])):(m(),O(u,{key:1}))]),_:1},8,["button","message","locale"])}}});const Ga=M(Ha,[["__scopeId","data-v-b55e385e"]]),Ya={xbAudio:Ze,xbBuilder:Ba,xbCopyright:qa,xbBeian:za,xbIcons:it,xbRender:ot,xbVideo:rt,xbView:Ga},dt=e=>{Object.entries(Ya).forEach(([t,n])=>{e.component(t,n)})},Ie=ke(vn);Te(Ie);dt(Ie);Ie.mount("#app");export{gn as l,Dn as r,js as u};

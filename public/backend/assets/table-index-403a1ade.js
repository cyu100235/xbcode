import"./vue-01dcdced.js";import{k as X,m as F,n as Z,p as ee,q as fe,_ as A,a as q,r as ge,s as ve,j as ne,t as he,v as ye,w as K,x as xe,y as be,c as we,z as oe,A as Ce,B as ke,C as $e,D as Pe,E as ce,o as Ve,F as re,G as De,H as Be,u as Ie,g as qe}from"./exception-error-8d49a4c1.js";import"./vxe-table-166d2ab0.js";import{V as Ee}from"./@vxe-ui-a46a5faa.js";import{r as Te,u as Me}from"./xlsx-04f2268f.js";import{j as g,d as x,e as P,o as p,c as y,a as L,G as r,_ as C,a2 as T,A as b,h as $,$ as f,a1 as O,ai as B,aj as I,f as v,F as H,ae as j,M as D,L as J,aq as R,a0 as Le,y as Re,B as G,x as N,ag as Q,W as Ae,X as Fe,V as Oe,s as He}from"./@vue-be2e89c4.js";import{i as je,a as Xe}from"./element-plus-a038b0d8.js";import{a as le,u as se}from"./vue-router-5591487d.js";import{_ as Se}from"./form-index-dd780621.js";const ie=async(t,e="GET",o={})=>await X({url:t,method:e,params:o}),Ue={height:"auto",border:!1,showOverflow:!0,keepSource:!0,rowConfig:{keyField:"id"},columnConfig:{resizable:!0},pagerConfig:{enabled:!0,total:0,currentPage:1,pageSize:30,background:!0,layouts:["PrevJump","PrevPage","Number","NextPage","NextJump","Sizes","FullJump","Total"]},editConfig:{trigger:"dblclick",mode:"row"},toolbarConfig:{custom:!0,slots:{buttons:"topButtons"}},proxyConfig:{seq:!0,props:{result:"result",total:"page.total"},ajax:{}},formConfig:{data:{name:""},items:[]},columns:[],data:[]},ze=(t,e,o)=>{X(o,{responseType:"blob"}).then(n=>{Ee.saveFile({filename:t,type:e,content:n.data})})},Ne=(t,e)=>new Promise((o,n)=>{var u,d,_;if(!((u=e.exportConfig)!=null&&u.api))return F("请设置请求API"),n(new Error("请设置请求API"));const s=t.options,a=(d=t.$grid)==null?void 0:d.getProxyInfo(),i={format:s.type??"xlsx",filename:s.filename??"导出文件",sheetName:s.sheetName??"",isHeader:s.isHeader??!1,original:s.original??!1,mode:s.mode??"all",pager:a?a.pager:null,ids:s.mode==="selected"?s.data.map(h=>h.id):[],fields:s.columns.map(h=>({field:h.field,title:h.title}))},c={method:"POST",data:{...i}},l=((_=e.exportConfig)==null?void 0:_.api)??"";X(l,c).then(h=>{var k;const w=h;if(!((k=w==null?void 0:w.data)!=null&&k.url))return F("导出数据失败，缺少文件URL地址"),n(new Error("导出数据失败，缺少文件URL地址"));ze(i.filename,i.format,w.data.url),o(h)})}),Ge=(t,e)=>{const o=t.$grid,n=new FormData;return n.append("file",t.file),new Promise(s=>{var c;const a=((c=e.importConfig)==null?void 0:c.api)??"";X(a,{method:"POST",data:n}).then(l=>{const{msg:u}=l;Z(u||"操作成功"),o==null||o.commitProxy("query"),s(l)}).catch(l=>{console.error("导入失败",l)})})},Je=(t,e)=>(t.$grid,new Promise(o=>{const n=new FileReader;n.onload=s=>{const a=s.target?s.target.result:"",i=Te(a,{type:"binary"}),c=Me.sheet_to_json(i.Sheets.Sheet1);t.$table.loadData(c),Z("已将数据导入至本地表格"),o(c)},n.readAsBinaryString(t.file)})),We=(t,e)=>{var o,n;return(o=e.importConfig)!=null&&o.api&&((n=e.importConfig)!=null&&n.is_server)?Ge(t,e):Je(t)},Ke=(t,e)=>{const o=t.form,n=t.page,s=g({...o,...e.params,page:n.currentPage,limit:n.pageSize});return ie(e.api,e.method,s.value)},Qe=(t,e="GET",o={})=>{const n=g(Ue),s=g(),a=g([]),i=g([]),c=g([]),l=g(),u=g(),d=`${t}Table`;return ie(d,e,o).then(_=>{var w,k,E,m,U,W;if(_.code!==200)return Promise.reject(new Error("获取表格配置失败"));if(!n.value)return Promise.reject(new Error("没有表格配置"));if(Array.isArray(n.value)&&n.value.length<=0)return Promise.reject(new Error("没有更多的表格配置"));n.value=((w=_.data)==null?void 0:w.config)??{},u.value=((k=_.data)==null?void 0:k.headerDesc)??{},n.value.toolbarConfig={...n.value.toolbarConfig,slots:{buttons:"topButtons"}},n.value.toolbarConfig.import&&(n.value.importConfig={...n.value.importConfig,remote:!0,importMethod:z=>We(z,n.value)}),n.value.toolbarConfig.export&&(n.value.exportConfig={...n.value.exportConfig,remote:!0,exportMethod:z=>Ne(z,n.value)});const h={api:t,method:e,params:o};n.value.proxyConfig={...n.value.proxyConfig,ajax:{query:z=>Ke(z,h)}},a.value=((E=_.data)==null?void 0:E.topButtons)??[],i.value=((m=_.data)==null?void 0:m.rightButtons)??[],c.value=((U=_.data)==null?void 0:U.extraButtons)??[],l.value=((W=_.data)==null?void 0:W.tabsConfig)??[]}),{config:n,headerDesc:u,gridRef:s,topButtons:a,extraButtons:c,rightButtons:i,tabsConfig:l}},M=t=>{var n,s;const e=((n=t==null?void 0:t.slots)==null?void 0:n.default)??"";let o={};return["image","images"].includes(e)&&(o={style:{width:"25px",height:"25px",fit:"cover"}}),e==="input"&&(o={...o,placeholder:`请输入${t.title}`}),e==="select"&&(o={...o,placeholder:`请选择${t.title}`}),(s=t==null?void 0:t.params)!=null&&s.props&&(o={...o,...t.params.props}),o},V=(t,e)=>{let o=null;if(!t||!e)return o;if(t.includes(".")){const n=t.split(".");let s=e;n.forEach(a=>{s=s[a]}),o=s}else o=e[t];return o},S=(t,e)=>({column:t.column,$table:t.$table,$grid:t.$grid,row:t.row,value:e}),Ye=["src"],Ze={class:"text"},et=x({__name:"index",props:{scoped:{}},setup(t){const e=t,o=M(e.scoped.column),n=g((o==null?void 0:o.icon)||"Bell"),s=g((o==null?void 0:o.text)||"点击播放"),a=g((o==null?void 0:o.title)||"未知音频"),i=P(()=>V(e.scoped.column.field,e.scoped.row)),c=()=>{fe(i.value,a.value)};return(l,u)=>{const d=A;return p(),y("div",b({class:"xb-audio"},r(o)),[L("div",{class:"audio-content",onClick:c},[r(ee)(r(n))?(p(),y("img",{key:0,class:"icon",src:r(n)},null,8,Ye)):(p(),C(d,{key:1,icon:r(n)},null,8,["icon"])),L("span",Ze,T(r(s)),1)])],16)}}});const tt=q(et,[["__scopeId","data-v-2a09562c"]]),ot=x({__name:"index",props:{scoped:{}},setup(t){const e=t,o=M(e.scoped.column),n=P(()=>V(e.scoped.column.field,e.scoped.row)??"未知标签名"),s=g(o.default??"未知字典"),a=g((o==null?void 0:o.options)??{}),i=P(()=>a.value[n.value]??s.value),c=g(o.style??{}),l=P(()=>c.value[n.value]??{});return(u,d)=>{const _=$("el-tag");return p(),C(_,B(I(r(l))),{default:f(()=>[O(T(r(i)),1)]),_:1},16)}}}),nt=["innerHTML"],st=x({__name:"index",props:{scoped:{}},emits:["editClosed"],setup(t,{emit:e}){const o=t,n=M(o.scoped.column),s=P(()=>V(o.scoped.column.field,o.scoped.row));return(a,i)=>(p(),y("div",b(r(n),{innerHTML:r(s)}),null,16,nt))}}),at={class:"xb-icon"},ct=x({__name:"index",props:{scoped:{}},emits:["editClosed"],setup(t,{emit:e}){const o=t,n=e,s=M(o.scoped.column),a=g(!!s.edit),i=P(()=>V(o.scoped.column.field,o.scoped.row)),c=()=>{a.value&&ge().then(l=>{const u=l;n("editClosed",S(o.scoped,u))})};return(l,u)=>{const d=A,_=$("el-tooltip");return p(),y("div",at,[v(_,{disabled:!r(a),effect:"dark",content:"点击修改图标"},{default:f(()=>[v(d,b({class:{"icon-edit":r(a)}},r(s),{icon:r(i),onClick:c}),null,16,["class","icon"])]),_:1},8,["disabled"])])}}});const rt=q(ct,[["__scopeId","data-v-f4663c87"]]),lt={class:"xb-image-error"},it=x({__name:"index",props:{scoped:{}},setup(t){var i,c;const e=t,o=M(e.scoped.column),n=P(()=>V(e.scoped.column.field,e.scoped.row)),s=g(((c=(i=e==null?void 0:e.scoped.column)==null?void 0:i.params)==null?void 0:c.preview)||!0),a=P(()=>{var u;if(!s.value)return[];const l=((u=e.scoped.column.params)==null?void 0:u.default)||"";return n.value||l});return(l,u)=>{const d=A,_=$("el-image");return p(),C(_,b(r(o),{src:r(n),"preview-src-list":[r(a)],class:"xb-table-image"}),{error:f(()=>[L("div",lt,[v(d,{icon:"Picture"})])]),_:1},16,["src","preview-src-list"])}}});const ut=q(it,[["__scopeId","data-v-e67d245a"]]),dt={class:"xb-images"},pt={class:"xb-image-error"},_t=x({__name:"index",props:{scoped:{}},setup(t){var c;const e=t,o=((c=e.scoped.column.params)==null?void 0:c.limit)||3,n=M(e.scoped.column),s=P(()=>V(e.scoped.column.field,e.scoped.row)),a=g(s.value.slice(0,o)),i=P(()=>{var u;const l=((u=e.scoped.column.params)==null?void 0:u.default)||"";return s.value||[l]});return(l,u)=>{const d=A,_=$("el-image");return p(),y("div",dt,[(p(!0),y(H,null,j(r(a),(h,w)=>(p(),C(_,b({ref_for:!0},r(n),{key:w,src:h,"preview-src-list":r(i),class:"xb-item-image"}),{error:f(()=>[L("div",pt,[v(d,{icon:"Picture"})])]),_:2},1040,["src","preview-src-list"]))),128))])}}});const mt=q(_t,[["__scopeId","data-v-d1a3c671"]]),ft={class:"xb-pictuer"},gt={key:1,class:"info"},vt=["title","innerHTML"],ht=["title","innerHTML"],yt=x({__name:"index",props:{scoped:{}},setup(t){const e=t,o=M(e.scoped.column),n=P(()=>V(o.image,e.scoped.row)),s=P(()=>V(o.title,e.scoped.row)),a=P(()=>V(o.desc,e.scoped.row));return(i,c)=>{const l=A,u=$("el-image");return p(),y("div",ft,[r(o).image?(p(),C(u,{key:0,class:"pictuer",src:r(n),"preview-src-list":[r(n)]},{error:f(()=>[v(l,{icon:"Picture",size:26})]),_:1},8,["src","preview-src-list"])):D("",!0),r(s)||r(a)?(p(),y("div",gt,[r(s)?(p(),y("div",{key:0,title:r(s),class:"title",innerHTML:r(s)},null,8,vt)):D("",!0),r(a)?(p(),y("div",{key:1,title:r(a),class:"desc",innerHTML:r(a)},null,8,ht)):D("",!0)])):D("",!0)])}}});const xt=q(yt,[["__scopeId","data-v-d7fb7595"]]),bt=x({__name:"index",props:{scoped:{}},emits:["editClosed"],setup(t,{emit:e}){const o=t,n=e,s=M(o.scoped.column),a=g(V(o.scoped.column.field,o.scoped.row)),i=()=>{const c=V(o.scoped.column.field,o.scoped.row);a.value!==c&&n("editClosed",S(o.scoped,a.value))};return(c,l)=>{const u=$("el-input");return p(),C(u,b(r(s),{modelValue:r(a),"onUpdate:modelValue":l[0]||(l[0]=d=>J(a)?a.value=d:null),onBlur:i}),null,16,["modelValue"])}}}),wt=x({__name:"index",props:{scoped:{}},setup(t){const e=t,o=M(e.scoped.column),n=P(()=>V(e.scoped.column.field,e.scoped.row)),s=()=>{if(o.copy===!0)ve(n.value);else{const a=(o==null?void 0:o.target)??"_blank";window.open(n.value,a)}};return(a,i)=>(p(),y("div",{class:"xb-link",onClick:s},T(r(o).text?r(o).text:r(n)),1))}});const Ct=q(wt,[["__scopeId","data-v-2055fceb"]]),kt=x({__name:"index",props:{scoped:{}},emits:["editClosed"],setup(t,{emit:e}){const o=t,n=e,s=M(o.scoped.column),a=(s==null?void 0:s.options)??[],i=g(V(o.scoped.column.field,o.scoped.row)),c=l=>{const u=V(o.scoped.column.field,o.scoped.row);l!==u&&n("editClosed",S(o.scoped,l))};return(l,u)=>{const d=$("el-radio"),_=$("el-radio-group");return p(),C(_,{modelValue:r(i),"onUpdate:modelValue":u[0]||(u[0]=h=>J(i)?i.value=h:null),onChange:c},{default:f(()=>[(p(!0),y(H,null,j(r(a),(h,w)=>(p(),C(d,{value:h.value,key:w},{default:f(()=>[O(T(h.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])}}}),$t=x({__name:"index",props:{scoped:{}},emits:["editClosed"],setup(t,{emit:e}){const o=t,n=e,s=M(o.scoped.column),a=g(V(o.scoped.column.field,o.scoped.row)),i=c=>{const l=V(o.scoped.column.field,o.scoped.row);c!==l&&n("editClosed",S(o.scoped,c))};return(c,l)=>{const u=$("el-rate");return p(),C(u,b({modelValue:r(a),"onUpdate:modelValue":l[0]||(l[0]=d=>J(a)?a.value=d:null)},r(s),{onChange:i}),null,16,["modelValue"])}}}),Pt=x({__name:"index",props:{scoped:{}},setup(t){var i,c,l;const e=t,o=((l=(c=(i=e.scoped.column)==null?void 0:i.params)==null?void 0:c.props)==null?void 0:l.url)??"",n=e.scoped.column.field,s=P(()=>V(e.scoped.column.field,e.scoped.row)),a={[n]:s.value};return(u,d)=>{const _=ne;return p(),C(_,{api:r(o),ajaxParams:a},null,8,["api"])}}}),Vt=x({__name:"index",props:{scoped:{}},emits:["editClosed"],setup(t,{emit:e}){const o=t,n=e,s=M(o.scoped.column),a=(s==null?void 0:s.options)??[],i=g(V(o.scoped.column.field,o.scoped.row)),c=l=>{const u=V(o.scoped.column.field,o.scoped.row);l!==u&&n("editClosed",S(o.scoped,l))};return(l,u)=>{const d=$("el-option"),_=$("el-select");return p(),C(_,b({modelValue:r(i),"onUpdate:modelValue":u[0]||(u[0]=h=>J(i)?i.value=h:null)},r(s),{onChange:c}),{default:f(()=>[(p(!0),y(H,null,j(r(a),(h,w)=>(p(),C(d,b({ref_for:!0},h,{key:w}),null,16))),128))]),_:1},16,["modelValue"])}}}),Dt=x({__name:"index",props:{scoped:{}},emits:["editClosed"],setup(t,{emit:e}){const o=t,n=e,s=M(o.scoped.column),a=g(V(o.scoped.column.field,o.scoped.row)??""),i=c=>{n("editClosed",S(o.scoped,c))};return(c,l)=>{var d,_,h,w,k,E,m,U;const u=$("el-switch");return p(),C(u,{modelValue:r(a),"onUpdate:modelValue":l[0]||(l[0]=W=>J(a)?a.value=W:null),"active-action-icon":((d=r(s))==null?void 0:d.activeActionIcon)??"","active-color":((_=r(s))==null?void 0:_.activeColor)??"#13ce66","active-text":(h=r(s))==null?void 0:h.activeText,"active-value":((w=r(s))==null?void 0:w.activeValue)??"20","inactive-action-icon":((k=r(s))==null?void 0:k.inactiveActionIcon)??"","inactive-color":((E=r(s))==null?void 0:E.inactiveColor)??"#ff4949","inactive-text":(m=r(s))==null?void 0:m.inactiveText,"inactive-value":((U=r(s))==null?void 0:U.inactiveValue)??"10","inline-prompt":"",onChange:i},null,8,["modelValue","active-action-icon","active-color","active-text","active-value","inactive-action-icon","inactive-color","inactive-text","inactive-value"])}}}),Bt=x({__name:"index",props:{scoped:{}},setup(t){const e=t,o=Math.random(),n=M(e.scoped.column);var s=(n==null?void 0:n.default)??"未知标签";const a=P(()=>V(e.scoped.column.field,e.scoped.row)??s);return(i,c)=>{const l=$("el-tag");return p(),C(l,b(r(n),{key:r(o)}),{default:f(()=>[O(T(r(a)),1)]),_:1},16)}}}),It=["title"],qt=x({__name:"index",props:{scoped:{}},setup(t){var c;const e=t,o=M(e.scoped.column),n=g(((c=e.scoped.column.params)==null?void 0:c.trigger)??"");n.value=n.value.toLowerCase();const s=n.value==="dbclick"?"双击":"单击",a=n.value?`${s}查看详情`:"",i=P(()=>V(e.scoped.column.field,e.scoped.row));return(l,u)=>(p(),y("div",b({class:["xb-text",{"is-modal":r(n)}],title:r(a)},r(o)),T(r(i)),17,It))}});const Et=q(qt,[["__scopeId","data-v-0efb7924"]]),Tt=["innerHTML"],Mt=["innerHTML"],Lt=x({__name:"index",props:{scoped:{}},setup(t){var i,c,l,u;const e=t,o=M(e.scoped.column),n=g(((c=(i=e.scoped.column)==null?void 0:i.params)==null?void 0:c.prefix)??""),s=g(((u=(l=e.scoped.column)==null?void 0:l.params)==null?void 0:u.suffix)??""),a=P(()=>V(e.scoped.column.field,e.scoped.row));return(d,_)=>(p(),y("div",b(r(o),{class:"flex items-center"}),[r(n)?(p(),y("div",{key:0,innerHTML:r(n)},null,8,Tt)):D("",!0),L("div",null,T(r(a)),1),r(s)?(p(),y("div",{key:1,innerHTML:r(s)},null,8,Mt)):D("",!0)],16))}}),Rt=["src"],At={class:"text"},Ft=x({__name:"index",props:{scoped:{}},setup(t){var l,u,d,_,h,w;const e=t,o=g(((u=(l=e==null?void 0:e.scoped.column)==null?void 0:l.params)==null?void 0:u.icon)||"VideoPlay"),n=g(((_=(d=e==null?void 0:e.scoped.column)==null?void 0:d.params)==null?void 0:_.text)||"点击播放"),s=g(((w=(h=e==null?void 0:e.scoped.column)==null?void 0:h.params)==null?void 0:w.title)||"视频播放"),a=M(e.scoped.column),i=P(()=>V(e.scoped.column.field,e.scoped.row)),c=()=>{he(i.value,s.value)};return(k,E)=>{const m=A;return p(),y("div",b({class:"xb-video"},r(a)),[L("div",{class:"video-content",onClick:c},[r(ee)(r(o))?(p(),y("img",{key:0,class:"icon",src:r(o)},null,8,Rt)):(p(),C(m,{key:1,icon:r(o)},null,8,["icon"])),L("span",At,T(r(n)),1)])],16)}}});const Ot=q(Ft,[["__scopeId","data-v-ee4a42bd"]]),ue=t=>{var o;const e=[];for(const n of t)if(e.push(n.path),(o=n.children)!=null&&o.length){const s=ue(n.children);e.push(...s)}return e},Ht=()=>{const e=ye().menus;return ue(e)},jt=t=>Ht().includes(t),Y=t=>{const e={...t};return e.icon&&delete e.icon,e},Xt=(t,e)=>{t.pageData.aliasParams;const o=g({});return{...t.pageData.queryParams,...o.value}},St=t=>!!jt(t.pageData.path),Ut=async(t,e,o)=>{const n=g();return e==="GET"?n.value={params:o}:n.value={data:o},await X({url:t,method:e,...n.value})},zt=(t,e,o)=>{var i,c,l;const n=((i=t.message)==null?void 0:i.type)??"",s=((c=t.message)==null?void 0:c.title)??"",a=((l=t.message)==null?void 0:l.content)??"";K(a,s,n,t.message).then(()=>{const u=e==null?void 0:e.$grid,d=t.pageData.api??"",_=xe(t.pageData.method);Ut(d,_,o).then(h=>{const w=h,k=w.code===200?"success":"error",E=w.msg;u==null||u.commitProxy("query"),be(E,k,"温馨提示")})})},Nt={class:"xb-form-drawer"},Gt={key:0,class:"xb-buttons"},Jt=x({__name:"drawer",props:{api:{},method:{},params:{},initOk:{type:Function},submitOk:{type:Function},close:{type:Function}},setup(t){const e=t,o=g(),n=g(!1),s=g(),a=g(),i=u=>{s.value=u.result.extraConfig.submitBtn,a.value=u.result.extraConfig.resetBtn,e.initOk&&e.initOk(u)},c=()=>{n.value=!0,o.value.submit().then(u=>{e.submitOk&&e.submitOk(u)}).finally(()=>{n.value=!1})},l=()=>{e.close&&e.close()};return(u,d)=>{var w,k;const _=we,h=$("el-button");return p(),y("div",Nt,[v(_,b({class:"xb-form",ref_key:"formRef",ref:o},{api:u.api,method:u.method,params:u.params},R({initOk:i})),null,16),(w=r(s))!=null&&w.content&&((k=r(a))!=null&&k.content)?(p(),y("div",Gt,[v(h,b(r(s),{loading:r(n),class:"xb-button",onClick:c}),{default:f(()=>{var E;return[O(T((E=r(s))==null?void 0:E.content),1)]}),_:1},16,["loading"]),v(h,b(r(a),{class:"xb-button",onClick:l}),{default:f(()=>{var E;return[O(T((E=r(a))==null?void 0:E.content),1)]}),_:1},16)])):D("",!0)])}}});const Wt=q(Jt,[["__scopeId","data-v-935f19c4"]]),Kt={class:"xb-remote-modal"},Qt=x({__name:"modal",props:{api:{},params:{},close:{type:Function}},emits:["update:modelValue"],setup(t,{emit:e}){const o=g({api:t.api,ajaxParams:t.params,isModal:!0}),n=g(oe()),s=e,l={value:u=>{s("update:modelValue",u)},redirect:u=>{if(!u.url){K("重定向地址参数错误","温馨提示","error");return}if(ee(u.url)){K("重定向地址不合法","温馨提示","error");return}o.value.api=(u==null?void 0:u.url)??"";const d={...u.query??{}};o.value.ajaxParams=d,n.value=oe()},reload:()=>{n.value=oe()},close:t.close};return(u,d)=>{const _=ne;return p(),y("div",Kt,[(p(),C(_,b({key:r(n)},r(o),R(l)),null,16))])}}});const de=q(Qt,[["__scopeId","data-v-4576ce62"]]),Yt={class:"xb-table-modal"},Zt=x({__name:"modal",props:{api:{},method:{},params:{}},setup(t){return(e,o)=>{const n=me;return p(),y("div",Yt,[v(n,{api:e.api,method:e.method,params:e.params},null,8,["api","method","params"])])}}});const pe=q(Zt,[["__scopeId","data-v-2b223b2a"]]),eo=x({__name:"drawer",props:{currentView:{},componentProps:{},onClose:{type:Function}},emits:["onClose"],setup(t,{emit:e}){const o=t,n=()=>{o.onClose()};return(s,a)=>{const i=$("ElDrawer");return p(),C(i,b({class:"xb-drawer"},s.$attrs,{onClosed:n}),{default:f(()=>[(p(),C(Le(s.currentView),b(s.componentProps,{"onUpdate:close":s.onClose}),null,16,["onUpdate:close"]))]),_:1},16)}}}),te=(t,e,o)=>new Promise(n=>{const s=document.createElement("div");document.body.appendChild(s);const a=Re(eo,{title:"通用抽屉",closeOnClickModal:!1,closeOnPressEscape:!1,...o,modelValue:!0,currentView:t??{},componentProps:e,onClose:()=>{a.unmount(),s.remove()}}),i=()=>{a.unmount(),s.remove()};a.use(je),a.mount(s),n({close:i})}),to=(t,e,o,n)=>new Promise(s=>{const a=g();te(Wt,{api:t,method:e,params:o,submitOk:c=>{var l;(l=a.value)==null||l.close(),s(c)},close:()=>{var c;(c=a.value)==null||c.close()}},n).then(c=>{a.value=c})}),oo=(t,e,o,n)=>new Promise(s=>{const a=g();te(Ce,{api:t,method:e,params:o,close:()=>{var c,l;(c=a.value)==null||c.close(),s((l=a.value)==null?void 0:l.close)}},n).then(c=>{a.value=c})}),no=(t,e,o,n)=>new Promise(s=>{const a=g();te(de,{api:t,method:e,params:o,close:()=>{var c,l;(c=a.value)==null||c.close(),s((l=a.value)==null?void 0:l.close)}},n).then(c=>{a.value=c})}),so=(t,e,o,n)=>new Promise(s=>{const a=g();te(pe,{api:t,method:e,params:o,close:()=>{var c,l;(c=a.value)==null||c.close(),s((l=a.value)==null?void 0:l.close)}},n).then(c=>{a.value=c})}),ao=(t,e,o)=>{const n=e==null?void 0:e.$grid,s=t.pageData.api??"",a=t.pageData.method??"",i={...t.message};to(s,a,o,i).then(()=>{n==null||n.commitProxy("query")})},co=(t,e,o)=>{const n=e==null?void 0:e.$grid,s=t.pageData.api??"",a=t.pageData.method??"",i={...t.message};oo(s,a,o,i).then(()=>{n==null||n.commitProxy("query")})},ro=(t,e,o)=>{const n=e==null?void 0:e.$grid,s=t.pageData.api??"",a=t.pageData.method??"",i={...t.message};no(s,a,o,i).then(()=>{n==null||n.commitProxy("query")})},lo=(t,e,o)=>{const n=e==null?void 0:e.$grid,s=t.pageData.api??"",a=t.pageData.method??"",i={size:"60%",...t.message};so(s,a,o,i).then(()=>{n==null||n.commitProxy("query")})},io=(t,e,o)=>{if(!t.pageData.api){F("未配置链接地址");return}const n=t.pageData.target||"_blank";if(ee(t.pageData.api)){window.open(t.pageData.api,n);return}X({url:t.pageData.api,method:t.pageData.method,params:o}).then(s=>{var l,u;const a=s,i=(l=a.data)==null?void 0:l.url,c=ke(((u=a.data)==null?void 0:u.query)??{});if(i){const d=c?`${i}?${c}`:i;window.open(d,n)}else F("未获取到跳转链接地址")})},uo=(t,e,o)=>{const n={customClass:"xb-modal-mask"},s=e==null?void 0:e.$grid,a=t.pageData.api??"",i=t.pageData.method??"GET";$e(a,i,o,{...t.message,...n}).then(()=>{s.commitProxy("query")})},po=(t,e,o)=>{const n={customClass:"xb-modal-button-none"},s=e==null?void 0:e.$grid,a=t.pageData.api??"",i=t.pageData.method??"";Pe(a,i,o,{...t.message,...n}).then(()=>{s.commitProxy("query")})},_o=(t,e,o)=>new Promise(n=>{const s={api:t,params:e,close:()=>{Xe.close(),n({})}},a={...o,showClose:!0,customClass:"xb-modal-button-none"};ce(de,s,a).catch(i=>{n(i)})}),mo=(t,e,o)=>{const n=e==null?void 0:e.$grid,s=t.pageData.api??"";_o(s,o,t.message).then(()=>{n.commitProxy("query")})},fo=async(t,e="GET",o={},n)=>new Promise(s=>{const a={api:t,method:e,params:o,initOk:()=>{}},i={...n,showClose:!0,customClass:"xb-modal-button-none"};ce(pe,a,i).catch(c=>{s(c)})}),go=(t,e,o)=>{const n=e==null?void 0:e.$grid,s=t.pageData.api??"",a=t.pageData.method??"";fo(s,a,o,t.message).then(()=>{n.commitProxy("query")})},vo=(t,e,o)=>{if(!t.pageData.path)return F("跳转地址不能为空");const n=t.pageData.path??"";Ve(`/${n}`,o)},ho=(t,e)=>{const o=g({});if(e)for(const n in e){const s=e[n],a=t[n]??"";o.value[s]=a}return o},yo=(t,e)=>{const o=re.currentRoute.value;return{...t.pageData.queryParams,redirect:t.pageData.isBack?o.fullPath:void 0}},xo=(t,e)=>{var l,u,d;const o=re.currentRoute.value,n=e.row,s=((d=(u=(l=e==null?void 0:e.$grid)==null?void 0:l.props)==null?void 0:u.rowConfig)==null?void 0:d.keyField)??"id",a=n[s]??"",i=ho(n,t.pageData.aliasParams);return{[s]:a,...t.pageData.queryParams,...i.value,redirect:t.pageData.isBack?o.fullPath:void 0}},ae=(t,e,o)=>{const n=t.pageData.type??"page",s={page:vo,link:io,confirm:zt,table:go,modal:uo,remote:mo,info:po,drawerForm:ao,drawerInfo:co,drawerTable:lo,drawerRemote:ro};if(!s[n]){F("事件类型错误");return}let a={};e.column?a=xo(t,e):a=yo(t),o={...o,...a},s[n](t,e,o)},_e=t=>{var s,a,i,c,l,u;if((a=(s=t.column)==null?void 0:s.slots)!=null&&a.default&&((i=t==null?void 0:t.column)==null?void 0:i.fixed)==="right")return;const e=(l=(c=t.column.params)==null?void 0:c.pageData)==null?void 0:l.type,o=(u=t.column.params)==null?void 0:u.message;if(!e||!o)return;const n=t.column.params;ae(n,t)},bo=t=>{var o;const e=((o=t.column.params)==null?void 0:o.trigger)??"";e&&e.toLowerCase()==="click"&&_e(t)},wo=t=>{var o;const e=((o=t.column.params)==null?void 0:o.trigger)??"";e&&e.toLowerCase()==="dbclick"&&_e(t)},Co=async(t,e)=>{if(!t){K("请设置请求API接口","温馨提示","error");return}return await De(t,e)},ko=t=>{var l,u,d,_;const e=t.column,o=t.row,n=((l=t.column.params)==null?void 0:l.keyField)??"id",s=t.value??"",a=((u=t.column.params)==null?void 0:u.api)??"",i=((_=(d=t.column)==null?void 0:d.params)==null?void 0:_.query)??{},c={[n]:o[n],keyField:n,field:e==null?void 0:e.field,value:s,...i};Co(a,c).then(h=>{h.code===200&&(t.$grid.commitProxy("query"),Z((h==null?void 0:h.msg)??"编辑成功"))})},$o={key:0,class:"no-group-button"},Po=x({__name:"ordinary",props:{scoped:{},config:{},buttonList:{}},setup(t){const e=t,o=n=>{var u;const s=n.field,a=((u=e.config.rowConfig)==null?void 0:u.keyField)??"id",i=e.scoped.$grid.getCheckboxRecords();if(i.length<=0)return F("请先选择数据");const c=i.map(d=>d[a]),l={field:s,keyField:a,value:c};ae(n,e.scoped,l)};return(n,s)=>{const a=A,i=$("el-button"),c=G("auth");return n.buttonList.length?(p(),y("div",$o,[(p(!0),y(H,null,j(n.buttonList,(l,u)=>N((p(),y("div",{class:"item",key:u},[v(i,b({ref_for:!0},r(Y)(l.button),{onClick:d=>o(l)}),Q({default:f(()=>[O(" "+T(l.title),1)]),_:2},[l.button.icon?{name:"icon",fn:f(()=>[v(a,b({icon:l.button.icon,ref_for:!0},l.button.iconAttrs),null,16,["icon"])]),key:"0"}:void 0]),1040,["onClick"])])),[[c,l.pageData.path]])),128))])):D("",!0)}}});const Vo=q(Po,[["__scopeId","data-v-10a6a2b0"]]),Do={key:0,class:"xb-extra-buttons"},Bo=x({__name:"index",props:{scoped:{},config:{},extraButtons:{}},setup(t){var n;const o=(n=t.config.columns)==null?void 0:n.find(s=>s.type==="checkbox");return(s,a)=>s.extraButtons.length&&r(o)?(p(),y("div",Do,[v(Vo,{"button-list":s.extraButtons,scoped:s.scoped,config:s.config},null,8,["button-list","scoped","config"])])):D("",!0)}});const Io=q(Bo,[["__scopeId","data-v-2c7fdabd"]]),qo=x({__name:"form",props:{config:{}},setup(t){const e=t,o=le(),n=se(),s=g(e.config.formConfig),a={submit(i){const c=i.data;o.push({path:n.path,query:{...n.query,...c}})},reset(){o.push({path:n.path,query:{}})}};return(i,c)=>{const l=$("vxe-form");return p(),C(l,b(r(s),R(a)),null,16)}}}),Eo=x({__name:"remote",props:{config:{}},setup(t){return(e,o)=>{const n=ne;return p(),C(n,{api:e.config.file,"ajax-params":e.config.ajaxParams},null,8,["api","ajax-params"])}}}),To={class:"xb-tabs"},Mo=["onClick"],Lo={class:"text"},Ro=x({__name:"tabs",props:{config:{}},setup(t){var u,d;const e=t,o=g(((u=e.config)==null?void 0:u.list)??[]),n=se(),s=le(),a=((d=e.config)==null?void 0:d.field)??"",i=n==null?void 0:n.query[a],c=P(()=>{var _;return i??((_=e.config)==null?void 0:_.active)}),l=_=>{s.push({query:{...n.query,[a]:_.value}})};return(_,h)=>{const w=A;return p(),y("div",To,[(p(!0),y(H,null,j(r(o),(k,E)=>(p(),y("div",{class:Ae(["item",{active:r(c)===(k==null?void 0:k.value)}]),key:E,onClick:m=>l(k)},[k.icon?(p(),C(w,{key:0,icon:k.icon},null,8,["icon"])):D("",!0),L("span",Lo,T(k.label),1)],10,Mo))),128))])}}});const Ao=q(Ro,[["__scopeId","data-v-d8397be7"]]),Fo={key:0,class:"xb-form"},Oo={key:0,class:"xb-screen-remote"},Ho={key:1,class:"xb-screen-form"},jo={key:2,class:"xb-screen-tabs"},Xo={key:3,class:"xb-screen-alert"},So={class:"xb-alert"},Uo=["innerHTML"],zo=x({__name:"index",props:{scoped:{},config:{},tabsConfig:{},headerDesc:{}},setup(t){var i,c;const e=t,o=Array.isArray(e.config.formConfig),n=g(e.config.screenRemote??null),s=g(((i=e.tabsConfig)==null?void 0:i.list.length)??null),a=g(((c=e.headerDesc)==null?void 0:c.content)??null);return(l,u)=>{var _;const d=$("el-alert");return!r(o)||r(n)||r(s)||r(a)?(p(),y("div",Fo,[r(n)?(p(),y("div",Oo,[v(Eo,{config:r(n)},null,8,["config"])])):D("",!0),r(o)?D("",!0):(p(),y("div",Ho,[v(qo,{config:l.config},null,8,["config"])])),r(s)?(p(),y("div",jo,[v(Ao,{config:l.tabsConfig},null,8,["config"])])):D("",!0),r(a)?(p(),y("div",Xo,[L("div",So,[v(d,B(I((_=l.headerDesc)==null?void 0:_.props)),{default:f(()=>{var h,w;return[L("div",{innerHTML:(h=l.headerDesc)==null?void 0:h.content,style:Fe((w=l.headerDesc)==null?void 0:w.style)},null,12,Uo)]}),_:1},16)])])):D("",!0)])):D("",!0)}}});const No=q(zo,[["__scopeId","data-v-8cc5a6ae"]]),Go={class:"button-text"},Jo=x({__name:"dropdown",props:{scoped:{},buttonList:{}},setup(t){const e=t,o=P(()=>{var c;return((c=e.scoped.params)==null?void 0:c.button)??{type:"primary",link:!0}}),n=P(()=>{var c,l;return((l=(c=e.scoped.params)==null?void 0:c.button)==null?void 0:l.position)??"right"}),s=P(()=>{var c,l;return((l=(c=e.scoped.params)==null?void 0:c.button)==null?void 0:l.icon)??"Expand"}),a=P(()=>{var c,l;return((l=(c=e.scoped.params)==null?void 0:c.button)==null?void 0:l.text)??"更多功能"}),i=c=>{ae(c,e.scoped)};return(c,l)=>{const u=A,d=$("el-button"),_=$("el-dropdown-item"),h=$("el-dropdown-menu"),w=$("el-dropdown");return p(),C(w,{onCommand:i},{dropdown:f(()=>[v(h,null,{default:f(()=>[(p(!0),y(H,null,j(c.buttonList,k=>(p(),C(_,{command:k},{default:f(()=>[k.button.icon?(p(),C(u,{key:0,icon:k.button.icon},null,8,["icon"])):D("",!0),L("span",null,T(k.title),1)]),_:2},1032,["command"]))),256))]),_:1})]),default:f(()=>[v(d,B(I(r(o))),{default:f(()=>[r(s)&&r(n)==="left"?(p(),C(u,{key:0,icon:r(s),size:"16"},null,8,["icon"])):D("",!0),L("span",Go,T(r(a)),1),r(s)&&r(n)==="right"?(p(),C(u,{key:1,icon:r(s),size:"16"},null,8,["icon"])):D("",!0)]),_:1},16)]),_:1})}}});const Wo=q(Jo,[["__scopeId","data-v-cfd4a14c"]]),Ko=x({__name:"ordinary",props:{scoped:{},buttonList:{}},setup(t){return(e,o)=>{const n=A,s=$("el-button"),a=G("xbEvent"),i=G("auth");return p(!0),y(H,null,j(e.buttonList,(c,l)=>N((p(),C(s,b({key:l,ref_for:!0},r(Y)(c.button)),Q({default:f(()=>[O(" "+T(c.title),1)]),_:2},[c.button.icon?{name:"icon",fn:f(()=>[v(n,b({ref_for:!0},c.button.iconAttrs,{icon:c.button.icon}),null,16,["icon"])]),key:"0"}:void 0]),1040)),[[a,{button:c,scoped:e.scoped}],[i,c.pageData.path]])),128)}}}),Qo={class:"xb-right-buttons"},Yo=x({__name:"index",props:{scoped:{},config:{},rightButtons:{}},setup(t){const e=t,o=P(()=>e.rightButtons.filter(s=>s.pageData.group&&St(s))),n=P(()=>e.rightButtons.filter(s=>!s.pageData.group));return(s,a)=>(p(),y("div",Qo,[r(o).length?(p(),C(Wo,{key:0,"button-list":r(o),scoped:s.scoped,class:"group"},null,8,["button-list","scoped"])):D("",!0),r(n).length?(p(),C(Ko,{key:1,"button-list":r(n),scoped:s.scoped},null,8,["button-list","scoped"])):D("",!0)]))}});const Zo=q(Yo,[["__scopeId","data-v-0d941223"]]),en=x({__name:"index",props:{action:{},query:{}},emits:["success","error"],setup(t,{emit:e}){const o=t,n=e,s=g({action:`${Be}/${o.action}`,data:o.query??{},showFileList:!1,headers:{Authorization:Ie().value,"X-Requested-With":"XMLHttpRequest"},beforeUpload:()=>{},onSuccess:a=>{if(n("success",a),a.code!==200){F(a.msg??"上传失败");return}Z(a.msg??"上传成功")},onError:a=>{n("error",a),F("上传失败")}});return(a,i)=>{const c=$("el-upload");return p(),C(c,B(I(r(s))),{default:f(()=>[Oe(a.$slots,"default")]),_:3},16)}}}),tn={key:0,class:"no-group-button"},on=x({__name:"ordinary",props:{scoped:{},buttonList:{}},setup(t){const e=t,o={success:n=>{e.scoped.$grid.commitProxy("query")},error:n=>{console.log("上传失败",n)}};return(n,s)=>{const a=A,i=$("el-button"),c=en,l=G("auth"),u=G("xbEvent");return n.buttonList.length?(p(),y("div",tn,[(p(!0),y(H,null,j(n.buttonList,(d,_)=>N((p(),y("div",{class:"item",key:_},[d.pageData.type==="upload"?(p(),C(c,b({key:0,action:d.pageData.api,query:r(Xt)(d)},R(o)),{default:f(()=>[N((p(),C(i,b({ref_for:!0},r(Y)(d.button)),Q({default:f(()=>[O(" "+T(d.title),1)]),_:2},[d.button.icon?{name:"icon",fn:f(()=>[v(a,b({icon:d.button.icon,ref_for:!0},d.button.iconAttrs),null,16,["icon"])]),key:"0"}:void 0]),1040)),[[l,d.pageData.path]])]),_:2},1040,["action","query"])):N((p(),C(i,b({key:1,ref_for:!0},r(Y)(d.button)),Q({default:f(()=>[O(" "+T(d.title),1)]),_:2},[d.button.icon?{name:"icon",fn:f(()=>[v(a,b({icon:d.button.icon,ref_for:!0},d.button.iconAttrs),null,16,["icon"])]),key:"0"}:void 0]),1040)),[[u,{button:d,scoped:n.scoped}]])])),[[l,d.pageData.path]])),128))])):D("",!0)}}}),nn={class:"xb-header-button"},sn=x({__name:"index",props:{scoped:{},config:{},topButtons:{}},setup(t){const e=t;return(o,n)=>(p(),y("div",nn,[v(on,{"button-list":e.topButtons,scoped:e.scoped},null,8,["button-list","scoped"])]))}});const an=q(sn,[["__scopeId","data-v-40591b80"]]),cn=x({__name:"index",props:{api:{},method:{},params:{}},emits:["update:init"],setup(t,{emit:e}){const o=t,n=e,{config:s,headerDesc:a,topButtons:i,rightButtons:c,extraButtons:l,tabsConfig:u}=Qe(o.api,o.method,o.params),d={cellClick:_=>bo(_),cellDblclick:_=>wo(_),editClosed:_=>ko(_)};return He(()=>{n("update:init")}),(_,h)=>{var E;const w=$("el-empty"),k=$("vxe-grid");return(E=r(s))!=null&&E.id?(p(),C(k,b({key:0,ref:"gridRef"},r(s),R(d)),{form:f(m=>[v(No,B(I({scoped:m,config:r(s),tabsConfig:r(u),headerDesc:r(a)})),null,16)]),topButtons:f(m=>[v(an,B(I({scoped:m,config:r(s),topButtons:r(i)})),null,16)]),rightButtons:f(m=>[v(Zo,B(I({scoped:m,config:r(s),rightButtons:r(c)})),null,16)]),bottom:f(m=>[v(Io,B(I({scoped:m,config:r(s),extraButtons:r(l)})),null,16)]),text:f(m=>[v(Et,B(I({scoped:m})),null,16)]),icon:f(m=>[v(rt,b({scoped:m},R(d)),null,16)]),image:f(m=>[v(ut,B(I({scoped:m})),null,16)]),images:f(m=>[v(mt,B(I({scoped:m})),null,16)]),imgtext:f(m=>[v(xt,B(I({scoped:m})),null,16)]),input:f(m=>[v(bt,b({scoped:m},R(d)),null,16)]),select:f(m=>[v(Vt,b({scoped:m},R(d)),null,16)]),radio:f(m=>[v(kt,b({scoped:m},R(d)),null,16)]),rate:f(m=>[v($t,b({scoped:m},R(d)),null,16)]),link:f(m=>[v(Ct,B(I({scoped:m})),null,16)]),remote:f(m=>[v(Pt,B(I({scoped:m})),null,16)]),switch:f(m=>[v(Dt,b({scoped:m},R(d)),null,16)]),tag:f(m=>[v(Bt,B(I({scoped:m})),null,16)]),dict:f(m=>[v(ot,B(I({scoped:m})),null,16)]),unit:f(m=>[v(Lt,B(I({scoped:m})),null,16)]),html:f(m=>[v(st,B(I({scoped:m})),null,16)]),audio:f(m=>[v(tt,B(I({scoped:m})),null,16)]),video:f(m=>[v(Ot,B(I({scoped:m})),null,16)]),empty:f(()=>[v(w,{description:"当前没有更多数据"})]),_:1},16)):D("",!0)}}});const me=q(cn,[["__scopeId","data-v-82e742fa"]]),rn={class:"xb-table-pro"},ln={class:"xb-table"},un=x({name:"/table"}),dn=x({...un,setup(t){const e=se(),o=g(e.meta.title),n=g(e.query),s=g(qe(e.meta.ajaxParams)),a=g({api:e.path,method:e.meta.method,params:{...n.value,...s.value}});return(i,c)=>{const l=Se,u=me;return p(),y("div",rn,[v(l,{title:r(o)},null,8,["title"]),L("div",ln,[v(u,B(I(r(a))),null,16)])])}}});const pn=q(dn,[["__scopeId","data-v-83d5b6e8"]]),wn=Object.freeze(Object.defineProperty({__proto__:null,default:pn},Symbol.toStringTag,{value:"Module"}));export{me as _,jt as a,wn as b,V as g,pn as i,ae as t};
